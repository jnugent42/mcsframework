from ROOT import TH1D, TH2D, TCanvas, TLegend, TFile, TText, TGraph, TROOT, TColor
from array import array
TROOT.gROOT.SetBatch(1)

convergence =  TH2D("",";No. of iterations;#chi^{2}_{n}-#chi^{2}_{n-1}",100,0,100,1000,0,100)
import re
i=0
xlist, ylist = array('d'),array('d')
for line in open('../lih200/log.txt'):
	match = re.search('Chi\^2 of change ([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+))', line)
	if match:
                i+=1
		xlist.append(i)
		print match.group(1)
		ylist.append(float(match.group(1)))
	        convergence.Fill(i,float(match.group(1)));
	else :
		match = re.search('Chi\^2 of change (\d+\.\d+)', line)
	        if match:
                           i+=1
			   xlist.append(i)
			   print match.group(1)
			   ylist.append(float(match.group(1)))
			   convergence.Fill(i,float(match.group(1)));

c = TCanvas("c","")
c.SetLogy()
print i
graphcon = TGraph(100,xlist,ylist)
#convergence.GetYaxis().SetRangeUser(1e-2,10)
graphcon.SetTitle("Convergence of Deconvolution")
graphcon.GetXaxis().SetTitle("No. of iterations")
graphcon.GetYaxis().SetTitle("Change in #chi^{2} from previous iteration")
graphcon.Draw()
c.Print("convergence.pdf")

f0 = TFile("../lih172/LihMuon_03172.root")
f1 = TFile("../lih200/LihMuon_03200.root")
f2 = TFile("../lih240/LihMuon_03240.root")
#f3 = TFile("XePion_03240.root")


# fz0 = TFile("../ZeroMuon_3172.root")
# fz1 = TFile("../ZeroMuon_03200_LiHMC.root")
# fz2 = TFile("../ZeroMuon_03240_LiHMC.root")

h0 = f0.Get("thetaX_data")
h1 = f1.Get("thetaX_data")
h2 = f2.Get("thetaX_data")
#h3 = f3.Get("thetaX_data")

hy0 = f0.Get("thetaY_data")
hy1 = f1.Get("thetaY_data")
hy2 = f2.Get("thetaY_data")

hz0 = f0.Get("thetaX_ref")
hz1 = f1.Get("thetaX_ref")
hz2 = f2.Get("thetaX_ref")
#hz3 = f3.Get("thetaX_ref")

ht0 = f0.Get("thetaX_GEANT")
ht1 = f1.Get("thetaX_GEANT")
ht2 = f2.Get("thetaX_GEANT")
#ht3 = f3.Get("thetaX_truthsim")

hrg0 = f0.Get("thetaY_recoGEANT")
hrg1 = f1.Get("thetaY_recoGEANT")
hrg2 = f2.Get("thetaY_recoGEANT")

hm0 = f0.Get("thetaX_Moliere")
hm1 = f1.Get("thetaX_Moliere")
hm2 = f2.Get("thetaX_Moliere")
#hm3 = f3.Get("thetaX_truthsim")

hc0 = f0.Get("thetaX_Cobb")
hc1 = f1.Get("thetaX_Cobb")
hc2 = f2.Get("thetaX_Cobb")
#hc3 = f3.Get("thetaX_Cobb")

h20 = f0.Get("dataUS_XY")
h21 = f1.Get("dataUS_XY")
h22 = f2.Get("dataUS_XY")

h20_px = h20.ProjectionX("h20_px")
h21_px = h21.ProjectionX("h21_px")
h22_px = h22.ProjectionX("h22_px")

m20 = f0.Get("dataUSref_XY")
m21 = f1.Get("dataUSref_XY")
m22 = f2.Get("dataUSref_XY")

m20_px = m20.ProjectionX("m20_px")
m21_px = m21.ProjectionX("m21_px")
m22_px = m22.ProjectionX("m22_px")

t1 = TText(0.18,0.885,"MICE Internal ISIS cycle 2015/04")
t2 = TText(0.18,0.85,"LiH, MAUS v3.1.2")
t1.SetNDC(1)
t1.SetTextSize(0.04)
t1.SetTextFont(42)
t2.SetNDC(1)
t2.SetTextSize(0.03)
t2.SetTextFont(42)

c = TCanvas("c","Scattering")
c.SetLogy(0)
c.SetBottomMargin(0.125)
c.SetLeftMargin(0.15)
c.SetTopMargin(0.07)
c.SetRightMargin(0.05)
leg = TLegend(0.7,0.7,0.99,0.99)
leg.SetLineColor(10)
h0.SetLineColor(4)
h0.SetMarkerColor(4)
h0.SetLineStyle(9)
h0.SetMarkerStyle(20)
h0.SetLineWidth(2)

h0.Sumw2()
n = h0.GetEntries()
h0.Scale(1./n)
h0.SetStats(0)
h0.Rebin(1)
print h0.GetXaxis().GetBinWidth(20)
leg.AddEntry(h0,"172 MeV/c","p")
h0.SetTitle(";#theta_{X} (radians);Probability per mrad")
binwidth = h0.GetXaxis().GetBinWidth(50)
print binwidth
# h0.Scale(0.001/binwidth)
h0.GetYaxis().SetTitleOffset(1.05)
# h0.GetXaxis().SetRangeUser(-0.06,0.06)
# h0.GetYaxis().SetRangeUser(5e-6,0.025)
h0.GetXaxis().SetLabelSize(0.05)
h0.GetXaxis().SetTitleSize(0.05)
h0.GetYaxis().SetLabelSize(0.05)
h0.GetYaxis().SetTitleSize(0.05)
h0.GetYaxis().SetTitleOffset(1.5)
h0*3
h0.GetXaxis().SetRangeUser(-0.0465,0.0465)
h0.Draw("pe")
print 'h0.Integral()',h0.Integral()

h1.Sumw2()
# h1.Scale(0.001/binwidth)
h1.SetLineColor(2)
h1.SetLineStyle(5)
h1.SetTitle(";#theta_{X} (radians);Probability per mrad")
h1.SetMarkerColor(2)
h1.SetMarkerStyle(25)
h1.SetLineWidth(2)
m = h1.GetEntries()
h1.Scale(1./m)
h1.Rebin(1)
leg.AddEntry(h1,"200 MeV/c","p")
h1*3
h1.GetXaxis().SetRangeUser(-0.0465,0.0465)
h1.Draw("pesame")
print 'h1.Integral()',h1.Integral()

h2.Sumw2()
# h2.Scale(0.001/binwidth)
h2.SetTitle(";#theta_{X} (radians);Probability per mrad")
h2.SetLineColor(1)
h2.SetLineStyle(1)
h2.SetLineColor(1)
# h2.SetMarkerStyle(22)
h2.SetLineWidth(2)
h2.SetMarkerColor(1)
h2.SetMarkerStyle(26)
q = h2.GetEntries()
h2.Scale(1./q)
h2.Rebin(1)
leg.AddEntry(h2,"240 MeV/c","p")
h2*3
h2.GetXaxis().SetRangeUser(-0.0465,0.0465)
h2.Draw("pesame")
print 'h2.Integral()',h2.Integral()
t1.Draw()
t2.Draw()

leg.Draw("same")
h0.GetYaxis().SetRangeUser(0,0.10)
h1.GetYaxis().SetRangeUser(0,0.10)
h2.GetYaxis().SetRangeUser(0,0.10)
c.Print("LiH_Raw_Combined.pdf")
c.Print("LiH_Raw_Combined_pq.jpg")

c = TCanvas("c","Scattering")
c.SetLogy(0)
c.SetBottomMargin(0.125)
c.SetLeftMargin(0.15)
c.SetTopMargin(0.07)
c.SetRightMargin(0.05)
leg = TLegend(0.7,0.7,0.99,0.99)
leg.SetLineColor(10)
hy0.SetLineColor(4)
hy0.SetMarkerColor(4)
hy0.SetLineStyle(9)
hy0.SetMarkerStyle(20)
hy0.SetLineWidth(2)

hy0.Sumw2()
ny = hy0.GetEntries()
hy0.Scale(1./ny)
hy0.SetStats(0)
hy0.Rebin(1)
print hy0.GetXaxis().GetBinWidth(20)
leg.AddEntry(hy0,"172 MeV/c","p")
hy0.SetTitle(";#theta_{Y} (radians);Probability per mrad")
binwidth = hy0.GetXaxis().GetBinWidth(50)
print binwidth
# hy0.Scale(0.001/binwidth)
hy0.GetYaxis().SetTitleOffset(1.05)
#hy0.GetXaxis().SetRangeUser(-0.06,0.06)
#hy0.GetYaxis().SetRangeUser(0,0.08)
hy0.GetXaxis().SetLabelSize(0.05)
hy0.GetXaxis().SetTitleSize(0.05)
hy0.GetYaxis().SetLabelSize(0.05)
hy0.GetYaxis().SetTitleSize(0.05)
hy0.GetYaxis().SetTitleOffset(1.5)
#hy0n = hy0.GetEntries()
#hy0.Scale(1./hy0n)
#hy0.GetYaxis().SetRangeUser(5e-6,0.08)
hy0*3
hy0.GetXaxis().SetRangeUser(-0.0465,0.0465)
hy0.Draw("pe")

hy1.Sumw2()
# hy1.Scale(0.001/binwidth)
hy1.SetLineColor(2)
hy1.SetTitle(";#theta_{Y} (radians);Probability per mrad")
hy1.SetLineStyle(5)
hy1.SetMarkerColor(2)
hy1.SetMarkerStyle(25)
hy1.SetLineWidth(2)
my = hy1.GetEntries()
hy1.Scale(1./my)
hy1.Rebin(1)
hy1.GetYaxis().SetRangeUser(5e-6,0.08)
leg.AddEntry(hy1,"200 MeV/c","p")
hy1*3
hy1.GetXaxis().SetRangeUser(-0.0465,0.0465)
hy1.Draw("pesame")

hy2.Sumw2()
# hy2.Scale(0.001/binwidth)
hy2.SetLineColor(1)
hy2.SetTitle(";#theta_{Y} (radians);Probability per mrad")
hy2.SetLineStyle(1)
hy2.SetLineColor(1)
#h2.SetMarkerStyle(22)
hy2.SetLineWidth(2)
hy2.SetMarkerColor(1)
hy2.SetMarkerStyle(26)
qy = hy2.GetEntries()
hy2.Scale(1./qy)
hy2.Rebin(1)
leg.AddEntry(hy2,"240 MeV/c","p")
hy2.GetYaxis().SetRangeUser(5e-6,0.08)
hy2*3
hy2.GetXaxis().SetRangeUser(-0.0465,0.0465)
hy2.Draw("pesame")
t1.Draw()
t2.Draw()

leg.Draw("same")

hy0.GetYaxis().SetRangeUser(0,0.10)
hy1.GetYaxis().SetRangeUser(0,0.10)
hy2.GetYaxis().SetRangeUser(0,0.10)
c.Print("LiH_Raw_Combinedy.pdf")
c.Print("LiH_Raw_Combinedy_pq.jpg")
'''
c.Clear()
leg.Clear()
t3 = TText(0.18,0.885,"MICE isis cycle 2015/03")
t3.SetNDC(1)
t3.SetTextSize(0.04)
t3.SetTextFont(42)
t4 = TText(0.18,0.85,"Xenon, Pion Beam, MAUS v3.1.2")
t4.SetNDC(1)
t4.SetTextSize(0.03)
t4.SetTextFont(42)
h3.SetLineColor(4)
h3.SetMarkerColor(4)
h3.SetLineStyle(9)
h3.SetMarkerStyle(20)
h3.SetLineWidth(2)

n = h3.GetEntries()
h3.Scale(1./n)
h3.SetStats(0)
h3.Rebin(1)
print h3.GetXaxis().GetBinWidth(20)
leg.AddEntry(h3,"240 MeV/c","p")
h3.SetTitle(";#theta_{X} (radians);Probability per mrad")
binwidth = h3.GetXaxis().GetBinWidth(50)
print binwidth
h3.Scale(0.001/binwidth)
h3.GetYaxis().SetTitleOffset(1.05)
h3.GetXaxis().SetRangeUser(-0.06,0.06)
h3.GetYaxis().SetRangeUser(5e-6,0.05)
h3.GetXaxis().SetLabelSize(0.05)
h3.GetXaxis().SetTitleSize(0.05)
h3.GetYaxis().SetLabelSize(0.05)
h3.GetYaxis().SetTitleSize(0.05)
h3.GetYaxis().SetTitleOffset(1.5)
h3.Draw("p")
t3.Draw()
t4.Draw()
leg.Draw()
c.Print("Xe_Raw.pdf")
c.Print("Xe_Raw_pq.jpg")

c.Clear()
leg.Clear()

t5 = TText(0.18,0.85,"Helium, Pion Beam, MAUS v3.1.2")
t5.SetNDC(1)
t5.SetTextSize(0.03)
t5.SetTextFont(42)
hz3.SetLineColor(4)
hz3.SetMarkerColor(4)
hz3.SetLineStyle(9)
hz3.SetMarkerStyle(20)
hz3.SetLineWidth(2)

n = hz3.GetEntries()
hz3.Scale(1./n)
hz3.SetStats(0)
hz3.Rebin(1)
print hz3.GetXaxis().GetBinWidth(20)
leg.AddEntry(hz3,"240 MeV/c","p")
hz3.SetTitle(";#theta_{X} (radians);Probability per mrad")
binwidth = hz3.GetXaxis().GetBinWidth(50)
print binwidth
hz3.Scale(0.001/binwidth)
hz3.GetYaxis().SetTitleOffset(1.05)
hz3.GetXaxis().SetRangeUser(-0.06,0.06)
hz3.GetYaxis().SetRangeUser(5e-6,0.05)
hz3.GetXaxis().SetLabelSize(0.05)
hz3.GetXaxis().SetTitleSize(0.05)
hz3.GetYaxis().SetLabelSize(0.05)
hz3.GetYaxis().SetTitleSize(0.05)
hz3.GetYaxis().SetTitleOffset(1.5)
hz3.Draw("p")
t3.Draw()
t5.Draw()
leg.Draw()
c.Print("He_Raw.pdf")
c.Print("He_Raw_pq.jpg")
'''
c.Clear()
leg.Clear()

# c.SetLogy()
hz0.SetLineColor(4)
hz0.SetLineStyle(9)
hz0.SetLineWidth(2)
hz0.SetMarkerColor(4)
hz0.SetMarkerStyle(20)
hz0.SetStats(0)
nz = hz0.GetEntries()
# hz0.Scale(1./nz)
hz0.Rebin(1)
hz0.GetXaxis().SetRangeUser(-0.06,0.06)
# hz0.SetMaximum(0.2)
#
print hz0.GetXaxis().GetBinWidth(20)
leg.AddEntry(hz0,"172 MeV/c","p")
hz0.SetTitle(";#theta_{X} (radians);Probability per mrad")
binwidth = hz0.GetXaxis().GetBinWidth(50)
print binwidth
# hz0.Scale(0.001/binwidth)
hz0.GetYaxis().SetRangeUser(5e-6,0.05)
hz0.GetXaxis().SetLabelSize(0.05)
hz0.GetXaxis().SetTitleSize(0.05)
hz0.GetYaxis().SetLabelSize(0.05)
hz0.GetYaxis().SetTitleSize(0.05)
hz0.GetYaxis().SetTitleOffset(1.5)
hz0.Draw("pe")


# hz1.Scale(0.001/binwidth)
hz1.SetLineColor(2)
hz1.SetLineStyle(5)
hz1.SetLineWidth(2)
hz1.SetMarkerColor(2)
hz1.SetMarkerStyle(25)
mz = hz1.GetEntries()
# hz1.Scale(1./mz)
hz1.Rebin(1)
leg.AddEntry(hz1,"200 MeV/c","p")
hz1.Draw("pe")


# hz2.Scale(0.001/binwidth)
hz2.SetLineColor(1)
hz2.SetLineStyle(1)
hz2.SetLineWidth(2)
hz2.SetMarkerColor(1)
hz2.SetMarkerStyle(26)
qz = hz2.GetEntries()
# hz2.Scale(1./qz)
hz2.Rebin(1)
leg.AddEntry(hz2,"240 MeV/c","p")
hz2.Draw("pe")

t6 = TText(0.18,0.85,"Zero Abs., Muon Beams, MAUS v3.1.2")
t6.SetNDC(1)
t6.SetTextSize(0.03)
t6.SetTextFont(42)
t1.Draw()
t6.Draw()
leg.Draw("same")
c.Print("Empty_Raw_Combined.pdf")
c.Print("Empty_Raw_Combined_pq.jpg")
leg.Clear()

c.SetLogy()
ht0.SetLineColor(4)
ht0.SetLineStyle(9)
ht0.SetLineWidth(2)
ht0.SetStats(0)
nz = ht0.GetEntries()
ht0.Scale(1./nz)
ht0.Rebin(1)
ht0.GetXaxis().SetRangeUser(-0.06,0.06)
ht0.GetYaxis().SetRangeUser(5e-5,0.1)
print ht0.GetXaxis().GetBinWidth(20)
leg.AddEntry(ht0,"172 MeV/c","l")
ht0.SetTitle(";#theta_{X} (radians);Probability per mrad")
binwidth = ht0.GetXaxis().GetBinWidth(50)
print binwidth
ht0.Scale(0.001/binwidth)
ht0.GetXaxis().SetLabelSize(0.05)
ht0.GetXaxis().SetTitleSize(0.05)
ht0.GetYaxis().SetLabelSize(0.05)
ht0.GetYaxis().SetTitleSize(0.05)
ht0.GetYaxis().SetTitleOffset(1.5)
ht0.Draw()

ht1.SetLineColor(2)
ht1.SetLineStyle(5)
ht1.SetLineWidth(2)
mz = ht1.GetEntries()
ht1.Scale(1./mz)
ht1.Scale(0.001/binwidth)
ht1.Rebin(1)
leg.AddEntry(ht1,"200 MeV/c","l")
ht1.Draw("same")

ht2.SetLineColor(1)
ht2.SetLineStyle(1)
ht2.SetLineWidth(2)
qz = ht2.GetEntries()
ht2.Scale(1./qz)
ht2.Scale(0.001/binwidth)
ht2.Rebin(1)
leg.AddEntry(ht2,"240 MeV/c","l")
ht2.Draw("same")

t7 = TText(0.18,0.885,"MICE GEANT4 Simulation")
t7.SetNDC(1)
t7.SetTextSize(0.04)
t7.SetTextFont(42)
t8 = TText(0.18,0.85,"LiH, Muon Beams, MAUS v3.1.2")
t8.SetNDC(1)
t8.SetTextSize(0.03)
t8.SetTextFont(42)
t7.Draw()
t8.Draw()
leg.Draw("same")
c.Print("GEANT4_LiH_Combined.pdf")
c.Print("GEANT4_LiH_Combined_pq.jpg")
leg.Clear()
'''
ht3.SetLineColor(1)
ht3.SetLineStyle(1)
ht3.SetLineWidth(2)
qz = ht3.GetEntries()
ht3.Scale(1./qz)
ht3.Scale(0.001/binwidth)
ht3.Rebin(1)
ht3.GetXaxis().SetRangeUser(-0.06,0.06)
ht3.GetYaxis().SetRangeUser(5e-5,0.1)
ht3.SetStats(0)
leg.AddEntry(ht3,"240 MeV/c","l")
ht3.Draw()
t7.Draw()
t4.Draw()
leg.Draw("same")
c.Print("GEANT4_Xe.pdf")
c.Print("GEANT4_Xe_pq.jpg")
leg.Clear()
'''
hrg0.SetLineColor(4)
hrg0.SetLineStyle(9)
hrg0.SetLineWidth(2)
hrg0.SetStats(0)
nz = hrg0.GetEntries()
hrg0.Scale(1./nz)
hrg0.Rebin(1)
hrg0.GetXaxis().SetRangeUser(-0.06,0.06)
#hrg0.GetYaxis().SetRangeUser(5e-6,0.1)
print hrg0.GetXaxis().GetBinWidth(20)
leg.AddEntry(hrg0,"172 MeV/c","l")
hrg0.SetTitle(";#theta_{Y} (radians);Probability per mrad")
binwidth = hrg0.GetXaxis().GetBinWidth(50)
print binwidth
hrg0.Scale(0.001/binwidth)
hrg0.GetXaxis().SetLabelSize(0.05)
hrg0.GetXaxis().SetTitleSize(0.05)
hrg0.GetYaxis().SetLabelSize(0.05)
hrg0.GetYaxis().SetTitleSize(0.05)
hrg0.GetYaxis().SetTitleOffset(1.5)
hrg0.DrawNormalized()

hrg1.SetLineColor(2)
hrg1.SetLineStyle(5)
hrg1.SetLineWidth(2)
mz = hrg1.GetEntries()
hrg1.Scale(1./mz)
hrg1.Scale(0.001/binwidth)
hrg1.Rebin(1)
hrg1.GetXaxis().SetRangeUser(-0.06,0.06)
#hrg1.GetYaxis().SetRangeUser(5e-6,0.1)
leg.AddEntry(hrg1,"200 MeV/c","l")
hrg1.DrawNormalized("same")

hrg2.SetLineColor(1)
hrg2.SetLineStyle(1)
hrg2.SetLineWidth(2)
qz = hrg2.GetEntries()
hrg2.Scale(1./qz)
hrg2.Scale(0.001/binwidth)
hrg2.Rebin(1)
hrg2.GetXaxis().SetRangeUser(-0.06,0.06)
#hrg2.GetYaxis().SetRangeUser(5e-6,0.1)
leg.AddEntry(hrg2,"240 MeV/c","l")
hrg2.DrawNormalized("same")


t90 = TText(0.38,0.22,"MICE Internal")
t90.SetNDC(1)
t90.SetTextSize(0.04)
t90.SetTextFont(42)
t10 = TText(0.38,0.15,"LiH, Muon Beams, MAUS v3.1.2")
t10.SetNDC(1)
t10.SetTextSize(0.03)
t10.SetTextFont(42)
t91 = TText(0.38,0.185,"ISIS cycle 2015/04")
t91.SetNDC(1)
t91.SetTextSize(0.04)
t91.SetTextFont(42)
t90.Draw()
t91.Draw()
t10.Draw()
t90.Draw()
t10.Draw()
leg.Draw("same")
c.Print("Deco_GEANT_Combined.pdf")
c.Print("Deco_GEANT_Combined_pq.jpg")
leg.Clear()
'''
hc3.SetLineColor(1)
hc3.SetLineStyle(1)
hc3.SetLineWidth(2)
qz = hc3.GetEntries()
hc3.Scale(1./qz)
hc3.Scale(0.001/binwidth)
hc3.Rebin(1)
hc3.GetXaxis().SetRangeUser(-0.06,0.06)
hc3.GetYaxis().SetRangeUser(5e-5,0.1)
hc3.SetStats(0)
leg.AddEntry(hc3,"240 MeV/c","l")
hc3.Draw()
t9.Draw()
t4.Draw()
leg.Draw("same")
c.Print("Carlisle-Cobb_Xe.pdf")
c.Print("Carlisle-Cobb_Xe_pq.jpg")
leg.Clear()
'''
hc0.SetLineColor(4)
hc0.SetLineStyle(9)
hc0.SetLineWidth(2)
hc0.SetStats(0)
nz = hc0.GetEntries()
hc0.Scale(1./nz)
hc0.Rebin(1)
hc0.GetXaxis().SetRangeUser(-0.06,0.06)
hc0.GetYaxis().SetRangeUser(5e-6,0.1)
print hc0.GetXaxis().GetBinWidth(20)
leg.AddEntry(hc0,"172 MeV/c","l")
hc0.SetTitle(";#theta_{X} (radians);Probability per mrad")
binwidth = hc0.GetXaxis().GetBinWidth(50)
print binwidth
hc0.Scale(0.001/binwidth)
hc0.GetXaxis().SetLabelSize(0.05)
hc0.GetXaxis().SetTitleSize(0.05)
hc0.GetYaxis().SetLabelSize(0.05)
hc0.GetYaxis().SetTitleSize(0.05)
hc0.GetYaxis().SetTitleOffset(1.5)
hc0.Draw()

hc1.SetLineColor(2)
hc1.SetLineStyle(5)
hc1.SetLineWidth(2)
mz = hc1.GetEntries()
hc1.Scale(1./mz)
hc1.Scale(0.001/binwidth)
hc1.Rebin(1)
hc1.GetXaxis().SetRangeUser(-0.06,0.06)
hc1.GetYaxis().SetRangeUser(5e-6,0.1)
leg.AddEntry(hc1,"200 MeV/c","l")
hc1.Draw("same")

hc2.SetLineColor(1)
hc2.SetLineStyle(1)
hc2.SetLineWidth(2)
qz = hc2.GetEntries()
hc2.Scale(1./qz)
hc2.Scale(0.001/binwidth)
hc2.Rebin(1)
hc2.GetXaxis().SetRangeUser(-0.06,0.06)
hc2.GetYaxis().SetRangeUser(5e-6,0.1)
leg.AddEntry(hc2,"240 MeV/c","l")
hc2.Draw("same")


t9 = TText(0.18,0.885,"MICE Carlisle-Cobb Simulation")
t9.SetNDC(1)
t9.SetTextSize(0.04)
t9.SetTextFont(42)
t10 = TText(0.18,0.85,"LiH, Muon Beams, MAUS v3.1.2")
t10.SetNDC(1)
t10.SetTextSize(0.03)
t10.SetTextFont(42)
t9.Draw()
t10.Draw()
t9.Draw()
t10.Draw()
leg.Draw("same")
c.Print("Cobb-Carlisle_Combined.pdf")
c.Print("Cobb-Carlisle_Combined_pq.jpg")
leg.Clear()

# Three models together

leg = TLegend(.65,.15,.95,.45)
c.SetLogy()
ht0.SetLineColor(4)
ht0.SetFillColor(0)
ht0.SetLineStyle(9)
ht0.SetLineWidth(2)
ht0.SetStats(0)
nz = ht0.GetEntries()
ht0.Scale(1./nz)
ht0.Rebin(1)
ht0.GetXaxis().SetRangeUser(-0.06,0.06)
# ht0.GetYaxis().SetRangeUser(5e-5,0.1)
print ht0.GetXaxis().GetBinWidth(20)
leg.AddEntry(ht0,"172 MeV/c GEANT 4.9.6.p02","l")
ht0.SetTitle(";#theta_{X} (radians);Probability per mrad")
binwidth = ht0.GetXaxis().GetBinWidth(50)
print binwidth
# ht0.Scale(0.001/binwidth)
ht0.GetXaxis().SetLabelSize(0.05)
ht0.GetXaxis().SetTitleSize(0.05)
ht0.GetYaxis().SetLabelSize(0.05)
ht0.GetYaxis().SetTitleSize(0.05)
ht0.GetYaxis().SetTitleOffset(1.5)
ht0.DrawNormalized()

hm0.SetLineColor(3)
hm0.SetLineStyle(8)
hm0.SetLineWidth(2)
hm0.SetStats(0)
nz2 = hm0.GetEntries()
hm0.Scale(1./nz)
hm0.Rebin(1)
print hm0.GetXaxis().GetBinWidth(20)
leg.AddEntry(hm0,"172 MeV/c Moliere","l")
hm0.SetTitle(";#theta_{X} (radians);Probability per mrad")
hm0.DrawNormalized("same")

hc0.SetLineColor(2)
hc0.SetLineStyle(7)
hc0.SetLineWidth(2)
hc0.SetStats(0)
nz = hc0.GetEntries()
hc0.Scale(1./nz)
hc0.Rebin(1)
print hc0.GetXaxis().GetBinWidth(20)
# leg.AddEntry(hc0,"172 MeV/c Cobb","l")
hc0.SetTitle(";#theta_{X} (radians);Probability per mrad")
# hc0.DrawNormalized("same E")

t7 = TText(0.18,0.885,"MICE preliminary [simulation]")

t7.SetNDC(1)
t7.SetTextSize(0.04)
t7.SetTextFont(42)
t8 = TText(0.18,0.85,"LiH, MAUS v3.1.2")
t8.SetNDC(1)
t8.SetTextSize(0.03)
t8.SetTextFont(42)
t7.Draw()
t8.Draw()
leg.Draw("same")
c.Print("Models_LiH_Combined.pdf")
c.Print("Models_LiH_Combined_pq.jpg")
leg.Clear()

# Next

c.SetLogy()
hm0.SetLineColor(4)
hm0.SetLineStyle(9)
hm0.SetLineWidth(2)
hm0.SetStats(0)
nz2 = hm0.GetEntries()
hm0.Scale(1./nz)
hm0.Rebin(1)
hm0.GetXaxis().SetRangeUser(-0.06,0.06)
hm0.GetYaxis().SetRangeUser(5e-5,0.1)
print hm0.GetXaxis().GetBinWidth(20)
leg.AddEntry(hm0,"172 MeV/c","l")
hm0.SetTitle(";#theta_{X} (radians);Probability per mrad")
binwidth = hm0.GetXaxis().GetBinWidth(50)
print binwidth
hm0.Scale(0.001/binwidth)
hm0.GetXaxis().SetLabelSize(0.05)
hm0.GetXaxis().SetTitleSize(0.05)
hm0.GetYaxis().SetLabelSize(0.05)
hm0.GetYaxis().SetTitleSize(0.05)
hm0.GetYaxis().SetTitleOffset(1.5)
hm0.Draw()

hm1.SetLineColor(2)
hm1.SetLineStyle(5)
hm1.SetLineWidth(2)
mz2 = hm1.GetEntries()
hm1.Scale(1./mz)
hm1.Scale(0.001/binwidth)
hm1.Rebin(1)
leg.AddEntry(hm1,"200 MeV/c","l")
hm1.Draw("same")

hm2.SetLineColor(1)
hm2.SetLineStyle(1)
hm2.SetLineWidth(2)
qz2 = hm2.GetEntries()
hm2.Scale(1./qz)
hm2.Scale(0.001/binwidth)
hm2.Rebin(1)
leg.AddEntry(hm2,"240 MeV/c","l")
hm2.Draw("same")

t70 = TText(0.18,0.885,"MICE Moliere Simulation")
t70.SetNDC(1)
t70.SetTextSize(0.04)
t70.SetTextFont(42)
t80 = TText(0.18,0.85,"LiH, Muon Beams, MAUS v3.1.2")
t80.SetNDC(1)
t80.SetTextSize(0.03)
t80.SetTextFont(42)
t70.Draw()
t80.Draw()
leg.Draw("same")
c.Print("Moliere_LiH_Combined.pdf")
c.Print("Moliere_LiH_Combined_pq.jpg")
leg.Clear()
c.Clear()
c.SetLogy(0)
leg.Clear()

leg.AddEntry(h20_px,"Data","l")
leg.AddEntry(m20_px,"MC","l")
h20_px.SetLineColor(1)
m20_px.SetLineColor(2)
m20_px.SetLineStyle(2)
m20_px.GetXaxis().SetLabelSize(0.05)
m20_px.GetXaxis().SetTitleSize(0.05)
m20_px.GetYaxis().SetLabelSize(0.05)
m20_px.GetYaxis().SetTitleSize(0.05)
n20 = h20_px.GetEntries()
h20_px.Scale(1./n20)
l20 = m20_px.GetEntries()
m20_px.Scale(1./l20)
m20_px.Draw()
h20_px.Draw("same")
leg.Draw("same")
# c.Print("Momentum_Dist_172MeV.pdf")

c.Clear()
leg.Clear()
leg.AddEntry(h21_px,"Data","l")
leg.AddEntry(m21_px,"MC","l")
h21_px.SetLineColor(1)
m21_px.SetLineColor(2)
m21_px.SetLineStyle(2)
m21_px.GetXaxis().SetLabelSize(0.05)
m21_px.GetXaxis().SetTitleSize(0.05)
m21_px.GetYaxis().SetLabelSize(0.05)
m21_px.GetYaxis().SetTitleSize(0.05)
n21 = h21_px.GetEntries()
h21_px.Scale(1./n21)
l21 = m21_px.GetEntries()
m21_px.Scale(1./l21)
m21_px.Draw()
h21_px.Draw("same")
leg.Draw("same")
# c.Print("Momentum_Dist_200MeV.pdf")

c.Clear()
leg.Clear()
leg.AddEntry(h22_px,"Data","l")
leg.AddEntry(m22_px,"MC","l")
h22_px.SetLineColor(1)
m22_px.SetLineColor(2)
m22_px.SetLineStyle(2)
m22_px.GetXaxis().SetLabelSize(0.05)
m22_px.GetXaxis().SetTitleSize(0.05)
m22_px.GetYaxis().SetLabelSize(0.05)
m22_px.GetYaxis().SetTitleSize(0.05)
n22 = h22_px.GetEntries()
h22_px.Scale(1./n22)
l22 = m22_px.GetEntries()
m22_px.Scale(1./l22)
m22_px.Draw()
h22_px.Draw("same")
leg.Draw("same")
# c.Print("Momentum_Dist_240MeV.pdf")


c.Clear()
leg.Clear()
tof01_0 = f0.Get("tof10")
# tof01_0.SetLabel(2,"US Track Found")
tof01_0.SetMarkerStyle(20)
'''
tof01_1 = f1.Get("tof10")
tof01_2 = f2.Get("tof10")
tof01_0.SetFillColor(2)
tof01_1.SetFillColor(4)
tof01_2.SetFillColor(8)
tof01_0.SetLineColor(2)
tof01_1.SetLineColor(4)
tof01_2.SetLineColor(8)
tof01_0.SetFillStyle(3003)
tof01_1.SetFillStyle(3004)
tof01_2.SetFillStyle(3005)
leg.AddEntry(tof01_0,"172 MeV/c","f")
leg.AddEntry(tof01_1,"200 MeV/c","f")
leg.AddEntry(tof01_2,"240 MeV/c","f")
'''
tof01_0.SetTitle("")
tof01_0.GetXaxis().SetRangeUser(24,33)
tof01_0.GetYaxis().SetRangeUser(0,3.5e4)
tof01_0.GetYaxis().SetTitle("Events per 0.2 ns")
tof01_0.GetXaxis().SetLabelSize(0.05)
tof01_0.GetXaxis().SetTitleSize(0.05)
tof01_0.GetYaxis().SetLabelSize(0.05)
tof01_0.GetYaxis().SetTitleSize(0.05)
tof01_0.GetYaxis().SetTitleOffset(1.25)
tof01_0.SetStats(0)
tof01_0.Draw("e1 p ")
#tof01_1.Draw("same")
#tof01_2.Draw("same")
#leg.Draw()
t1.Draw()
t2.Draw()
c.Print("TOF10_dist.pdf")
c.Print("TOF10_dist_pq.jpg")

c.Clear()
leg.Clear()
tof21_0 = f0.Get("tof21")
# tof01_0.SetLabel(2,"US Track Found")
tof21_0.SetMarkerStyle(20)
'''
tof01_1 = f1.Get("tof10")
tof01_2 = f2.Get("tof10")
tof01_0.SetFillColor(2)
tof01_1.SetFillColor(4)
tof01_2.SetFillColor(8)
tof01_0.SetLineColor(2)
tof01_1.SetLineColor(4)
tof01_2.SetLineColor(8)
tof01_0.SetFillStyle(3003)
tof01_1.SetFillStyle(3004)
tof01_2.SetFillStyle(3005)
leg.AddEntry(tof01_0,"172 MeV/c","f")
leg.AddEntry(tof01_1,"200 MeV/c","f")
leg.AddEntry(tof01_2,"240 MeV/c","f")
'''
# tof21_0.SetTitle("LiH Abs., Muon Beams, March 2016, MAUS v3.1.2")
tof21_0.GetXaxis().SetRangeUser(26,43)
tof21_0.GetYaxis().SetRangeUser(0,8e4)
tof21_0.GetYaxis().SetTitle("Events per 0.2 ns")
tof21_0.GetXaxis().SetLabelSize(0.05)
tof21_0.GetXaxis().SetTitleSize(0.05)
tof21_0.GetYaxis().SetLabelSize(0.05)
tof21_0.GetYaxis().SetTitleSize(0.05)
tof21_0.SetStats(0)
tof21_0.Draw("e1 p ")
#tof01_1.Draw("same")
#tof01_2.Draw("same")
#leg.Draw()
t1.Draw()
t2.Draw()
c.Print("TOF21_dist.pdf")

c.Clear()
leg.Clear()
mctof10_0 = f0.Get("mctof10")
# tof01_0.SetLabel(2,"US Track Found")
mctof10_0.SetMarkerStyle(20)
'''
tof01_1 = f1.Get("tof10")
tof01_2 = f2.Get("tof10")
tof01_0.SetFillColor(2)
tof01_1.SetFillColor(4)
tof01_2.SetFillColor(8)
tof01_0.SetLineColor(2)
tof01_1.SetLineColor(4)
tof01_2.SetLineColor(8)
tof01_0.SetFillStyle(3003)
tof01_1.SetFillStyle(3004)
tof01_2.SetFillStyle(3005)
leg.AddEntry(tof01_0,"172 MeV/c","f")
leg.AddEntry(tof01_1,"200 MeV/c","f")
leg.AddEntry(tof01_2,"240 MeV/c","f")
'''
# mctof10_0.SetTitle("LiH Abs., Muon Beams, March 2016, MAUS v3.1.2")
mctof10_0.GetXaxis().SetRangeUser(24,33)
# mctof10_0.GetYaxis().SetRangeUser(0,8e4)
mctof10_0.GetYaxis().SetTitle("Events per 0.2 ns")
mctof10_0.GetXaxis().SetLabelSize(0.05)
mctof10_0.GetXaxis().SetTitleSize(0.05)
mctof10_0.GetYaxis().SetLabelSize(0.05)
mctof10_0.GetYaxis().SetTitleSize(0.05)
mctof10_0.SetStats(0)
mctof10_0.Draw("e1 p ")
#tof01_1.Draw("same")
#tof01_2.Draw("same")
#leg.Draw()
t1.Draw()
t2.Draw()
c.Print("TOF10ref_dist.pdf")
leg.Clear()

c.SetLogy()
c.SetBottomMargin(0.15)
accept_0 = f0.Get("cuts_accept")
accept_1 = f1.Get("cuts_accept")
accept_2 = f2.Get("cuts_accept")
accept_0.SetFillColor(2)
accept_1.SetFillColor(4)
accept_2.SetFillColor(8)
accept_0.SetLineColor(2)
accept_1.SetLineColor(4)
accept_2.SetLineColor(8)
accept_0.SetFillColor(2)
accept_1.SetFillColor(4)
accept_2.SetFillColor(8)
accept_0.SetBarWidth(0.25)
accept_1.SetBarWidth(0.25)
accept_2.SetBarWidth(0.25)
accept_0.SetBarOffset(0.0)
accept_1.SetBarOffset(0.3)
accept_2.SetBarOffset(0.6)
accept_0.SetMinimum(1e3)
accept_0.SetMaximum(8e6)
accept_0.GetXaxis().SetRange(1,5)
accept_0.GetYaxis().SetRange(1,100000000)
#accept_0.SetTitle("LiH Abs., Muon Beams, March 2016, MAUS v3.1.2")
leg.AddEntry(accept_0,"172 MeV/c","f")
leg.AddEntry(accept_1,"200 MeV/c","f")
leg.AddEntry(accept_2,"240 MeV/c","f")
accept_0.GetXaxis().SetLabelSize(0.05)
accept_0.GetXaxis().SetTitleSize(0.05)
accept_0.GetYaxis().SetLabelSize(0.05)
accept_0.GetYaxis().SetTitleSize(0.05)
accept_0.GetXaxis().SetTitleOffset(1.25)
accept_0.SetStats(0)
accept_0.Draw("bar")
accept_1.Draw("barsame")
accept_2.Draw("barsame")
leg.Draw()
t1.Draw()
t2.Draw()
c.Print("LiH_Accept_Cuts.pdf")
c.Print("LiH_Accept_Cuts_pq.jpg")
c.SetLogy(0)

c.Clear()

print "Upstream track selection & There is one US track and at most one track in the DS tracker (If there is no DS track $\\theta_X = \\theta_Y = 45^{\\circ}$). & \multicolumn{3}{c}{",round(accept_0.GetBinContent(1)/accept_0.GetBinContent(1)*100,2),"}\%\\\\"
print "Diffuser cut & US tracks are projected to the diffuser position any track at a radius greater than 90 mm is rejected & \multicolumn{3}{c}{",round(accept_0.GetBinContent(3)/accept_0.GetBinContent(1)*100,2),"}\%\\\\"
print "Fiducial selection & For projected US tracks $\sqrt{x^{2} + y^{2}} < r_0$ at plane 5 of DS tracker, where $x = x_{0} + (\\frac{dx}{dz}\\Delta z)$, $y = y_{0} + (\\frac{dy}{dz}\\Delta z)$ and $r_0 = 90$ mm. & \multicolumn{3}{c}{",round(accept_0.GetBinContent(4)/accept_0.GetBinContent(1)*100,2),"}\%\\\\"
print "$\chi^2$ cut &  $\chi^2$/NDF $< 4$ upstream & \multicolumn{3}{c}{",round(accept_0.GetBinContent(5)/accept_0.GetBinContent(1)*100,2),"}\%\\\\"
print "TOF timing selection & Select muons in TOF window of width 200 ps, selection varies so that samples of various mean momenta from 172-240 MeV/c can be selected. & ",round(accept_0.GetBinContent(6)/accept_0.GetBinContent(1)*100,2),"\%&",round(accept_1.GetBinContent(6)/accept_1.GetBinContent(1)*100,2),"\%&",round(accept_2.GetBinContent(6)/accept_2.GetBinContent(1)*100,2),"\%\\\\"



# c.SetTopMargin(0.9)
# c.SetLogz()

c.SetRightMargin(0.15)
# c.SetBottomMargin(0.10)
XY_10 = f1.Get("dataUS_alltof_XY")
# XY_10.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.1.2")
XY_10.SetStats(0)
XY_10.SetTitle("")
# XY_10.SetMaximum(600)
XY_10.SetMinimum(50)
XY_10.GetXaxis().SetLabelSize(0.05)
XY_10.GetXaxis().SetTitleSize(0.05)
XY_10.GetYaxis().SetLabelSize(0.05)
XY_10.GetYaxis().SetTitleSize(0.05)
XY_10.Draw("colz")
col1 = 0.2082*0.9
col2 = 0.1664*0.9
col3 = 0.5293*0.9
fillcolour = TColor.GetColor(col1, col2, col3)
c.GetFrame().SetFillColor(fillcolour)
c.SetFrameFillColor(fillcolour)
# t1.Draw()
t2.Draw()
c.Print("dataUS_200_alltof_XY.pdf")
c.Print("dataUS_200_alltof_XY_pq.jpg")

c.Clear()
XY_11 = f1.Get("dataUS_dif_XY")
# XY_11.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.1.2")
XY_11.SetStats(0)
XY_11.SetTitle("")
# XY_11.SetMaximum(600)
XY_11.SetMinimum(2)
XY_11.GetXaxis().SetLabelSize(0.05)
XY_11.GetXaxis().SetTitleSize(0.05)
XY_11.GetYaxis().SetLabelSize(0.05)
XY_11.GetYaxis().SetTitleSize(0.05)
XY_11.Draw("colz")
fillcolour = TColor.GetColor(col1, col2, col3)
c.GetFrame().SetFillColor(fillcolour)
c.SetFrameFillColor(fillcolour)
# t1.Draw()
t2.Draw()
c.Print("dataUS_200_prerad_XY.pdf")
c.Print("dataUS_200_prerad_XY_pq.jpg")

c.Clear()
XY_12 = f1.Get("dataUS_XY")
# XY_12.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.1.2")
XY_12.SetStats(0)
XY_12.SetTitle("")
# XY_12.SetMaximum(600)
XY_12.SetMinimum(0)
XY_12.GetXaxis().SetLabelSize(0.05)
XY_12.GetXaxis().SetTitleSize(0.05)
XY_12.GetYaxis().SetLabelSize(0.05)
XY_12.GetYaxis().SetTitleSize(0.05)
XY_12.Draw("colz")
fillcolour = TColor.GetColor(col1, col2, col3)
c.GetFrame().SetFillColor(fillcolour)
c.SetFrameFillColor(fillcolour)
# t1.Draw()
t2.Draw()
c.Print("dataUS_200_XY.pdf")
c.Print("dataUS_200_XY_pq.jpg")

c.Clear()
dXdzdYdz_10 = f1.Get("dataUS_alltof_dXdzdYdz")
# dXdzdYdz_10.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.1.2")
dXdzdYdz_10.SetStats(0)
dXdzdYdz_10.SetTitle("")
# dXdzdYdz_10.SetMaximum(800)
dXdzdYdz_10.SetMinimum(20)
dXdzdYdz_10.GetXaxis().SetLabelSize(0.05)
dXdzdYdz_10.GetXaxis().SetTitleSize(0.05)
dXdzdYdz_10.GetYaxis().SetLabelSize(0.05)
dXdzdYdz_10.GetYaxis().SetTitleSize(0.05)
dXdzdYdz_10.GetXaxis().SetNdivisions(508)
dXdzdYdz_10.GetYaxis().SetNdivisions(508)
dXdzdYdz_10.Draw("colz")
fillcolour = TColor.GetColor(col1, col2, col3)
c.GetFrame().SetFillColor(fillcolour)
c.SetFrameFillColor(fillcolour)
# t1.Draw()
t2.Draw()
c.Print("dataUS_200_alltof_dXdzdYdz.pdf")
c.Print("dataUS_200_alltof_dXdzdYdz_pq.jpg")

c.Clear()
dXdzdYdz_11 = f1.Get("dataUS_dif_dXdzdYdz")
# dXdzdYdz_11.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.1.2)"
dXdzdYdz_11.SetStats(0)
dXdzdYdz_11.SetTitle("")
# dXdzdYdz_11.SetMaximum(800)
dXdzdYdz_11.SetMinimum(3)
dXdzdYdz_11.GetXaxis().SetLabelSize(0.05)
dXdzdYdz_11.GetXaxis().SetTitleSize(0.05)
dXdzdYdz_11.GetYaxis().SetLabelSize(0.05)
dXdzdYdz_11.GetYaxis().SetTitleSize(0.05)
dXdzdYdz_11.GetXaxis().SetNdivisions(508)
dXdzdYdz_11.GetYaxis().SetNdivisions(508)
dXdzdYdz_11.Draw("colz")
fillcolour = TColor.GetColor(col1, col2, col3)
c.GetFrame().SetFillColor(fillcolour)
c.SetFrameFillColor(fillcolour)
# t1.Draw()
t2.Draw()
c.Print("dataUS_200_prerad_dXdzdYdz.pdf")
c.Print("dataUS_200_prerad_dXdzdYdz_pq.jpg")

c.Clear()
dXdzdYdz_12 = f1.Get("dataUS_dXdzdYdz")
# dXdzdYdz_12.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.1.2")
dXdzdYdz_12.SetStats(0)
dXdzdYdz_12.SetTitle("")
# dXdzdYdz_12.SetMaximum(800)
dXdzdYdz_12.SetMinimum(0)
dXdzdYdz_12.GetXaxis().SetLabelSize(0.05)
dXdzdYdz_12.GetXaxis().SetTitleSize(0.05)
dXdzdYdz_12.GetYaxis().SetLabelSize(0.05)
dXdzdYdz_12.GetYaxis().SetTitleSize(0.05)
dXdzdYdz_12.GetXaxis().SetNdivisions(508)
dXdzdYdz_12.GetYaxis().SetNdivisions(508)
dXdzdYdz_12.Draw("colz")
fillcolour = TColor.GetColor(col1, col2, col3)
c.GetFrame().SetFillColor(fillcolour)
c.SetFrameFillColor(fillcolour)
# t1.Draw()
t2.Draw()
c.Print("dataUS_200_dXdzdYdz.pdf")
c.Print("dataUS_200_dXdzdYdz_pq.jpg")
# ================================================================


c.SetRightMargin(0.15)
# c.SetBottomMargin(0.10)
XY_10 = f1.Get("dataDS_alltof_XY")
# XY_10.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.1.2")
XY_10.SetStats(0)
XY_10.SetTitle("")
# XY_10.SetMaximum(600)
XY_10.SetMinimum(50)
XY_10.GetXaxis().SetLabelSize(0.05)
XY_10.GetXaxis().SetTitleSize(0.05)
XY_10.GetYaxis().SetLabelSize(0.05)
XY_10.GetYaxis().SetTitleSize(0.05)
XY_10.Draw("colz")
fillcolour = TColor.GetColor(col1, col2, col3)
c.GetFrame().SetFillColor(fillcolour)
c.SetFrameFillColor(fillcolour)
t1.Draw()
t2.Draw()
c.Print("dataDS_200_alltof_XY.pdf")
c.Print("dataDS_200_alltof_XY_pq.jpg")

c.Clear()
XY_11 = f1.Get("dataDS_dif_XY")
# XY_11.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.1.2")
XY_11.SetStats(0)
XY_11.SetTitle("")
# XY_11.SetMaximum(600)
XY_11.SetMinimum(2)
XY_11.GetXaxis().SetLabelSize(0.05)
XY_11.GetXaxis().SetTitleSize(0.05)
XY_11.GetYaxis().SetLabelSize(0.05)
XY_11.GetYaxis().SetTitleSize(0.05)
XY_11.Draw("colz")
fillcolour = TColor.GetColor(col1, col2, col3)
c.GetFrame().SetFillColor(fillcolour)
c.SetFrameFillColor(fillcolour)
# t1.Draw()
t2.Draw()
c.Print("dataDS_200_prerad_XY.pdf")
c.Print("dataDS_200_prerad_XY_pq.jpg")

c.Clear()
XY_12 = f1.Get("dataDS_XY")
# XY_12.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.1.2")
XY_12.SetStats(0)
XY_12.SetTitle("")
# XY_12.SetMaximum(600)
XY_12.SetMinimum(0)
XY_12.GetXaxis().SetLabelSize(0.05)
XY_12.GetXaxis().SetTitleSize(0.05)
XY_12.GetYaxis().SetLabelSize(0.05)
XY_12.GetYaxis().SetTitleSize(0.05)
XY_12.Draw("colz")
fillcolour = TColor.GetColor(col1, col2, col3)
c.GetFrame().SetFillColor(fillcolour)
c.SetFrameFillColor(fillcolour)
# t1.Draw()
t2.Draw()
c.Print("dataDS_200_XY.pdf")
c.Print("dataDS_200_XY_pq.jpg")

c.Clear()
dXdzdYdz_10 = f1.Get("dataDS_alltof_dXdzdYdz")
# dXdzdYdz_10.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.1.2")
dXdzdYdz_10.SetStats(0)
dXdzdYdz_10.SetTitle("")
# dXdzdYdz_10.SetMaximum(800)
dXdzdYdz_10.SetMinimum(20)
dXdzdYdz_10.GetXaxis().SetLabelSize(0.05)
dXdzdYdz_10.GetXaxis().SetTitleSize(0.05)
dXdzdYdz_10.GetYaxis().SetLabelSize(0.05)
dXdzdYdz_10.GetYaxis().SetTitleSize(0.05)
dXdzdYdz_10.GetXaxis().SetNdivisions(508)
dXdzdYdz_10.GetYaxis().SetNdivisions(508)
dXdzdYdz_10.Draw("colz")
fillcolour = TColor.GetColor(col1, col2, col3)
c.GetFrame().SetFillColor(fillcolour)
c.SetFrameFillColor(fillcolour)
# t1.Draw()
t2.Draw()
c.Print("dataDS_200_alltof_dXdzdYdz.pdf")
c.Print("dataDS_200_alltof_dXdzdYdz_pq.jpg")

c.Clear()
dXdzdYdz_11 = f1.Get("dataDS_dif_dXdzdYdz")
# dXdzdYdz_11.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.1.2)"
dXdzdYdz_11.SetStats(0)
dXdzdYdz_11.SetTitle("")
# dXdzdYdz_11.SetMaximum(800)
dXdzdYdz_11.SetMinimum(3)
dXdzdYdz_11.GetXaxis().SetLabelSize(0.05)
dXdzdYdz_11.GetXaxis().SetTitleSize(0.05)
dXdzdYdz_11.GetYaxis().SetLabelSize(0.05)
dXdzdYdz_11.GetYaxis().SetTitleSize(0.05)
dXdzdYdz_11.GetXaxis().SetNdivisions(508)
dXdzdYdz_11.GetYaxis().SetNdivisions(508)
dXdzdYdz_11.Draw("colz")
fillcolour = TColor.GetColor(col1, col2, col3)
c.GetFrame().SetFillColor(fillcolour)
c.SetFrameFillColor(fillcolour)
# t1.Draw()
t2.Draw()
c.Print("dataDS_200_prerad_dXdzdYdz.pdf")
c.Print("dataDS_200_prerad_dXdzdYdz_pq.jpg")

c.Clear()
dXdzdYdz_12 = f1.Get("dataDS_dXdzdYdz")
# dXdzdYdz_12.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.1.2")
dXdzdYdz_12.SetStats(0)
dXdzdYdz_12.SetTitle("")
# dXdzdYdz_12.SetMaximum(800)
dXdzdYdz_12.SetMinimum(0)
dXdzdYdz_12.GetXaxis().SetLabelSize(0.05)
dXdzdYdz_12.GetXaxis().SetTitleSize(0.05)
dXdzdYdz_12.GetYaxis().SetLabelSize(0.05)
dXdzdYdz_12.GetYaxis().SetTitleSize(0.05)
dXdzdYdz_12.GetXaxis().SetNdivisions(508)
dXdzdYdz_12.GetYaxis().SetNdivisions(508)
dXdzdYdz_12.Draw("colz")
fillcolour = TColor.GetColor(col1, col2, col3)
c.GetFrame().SetFillColor(fillcolour)
c.SetFrameFillColor(fillcolour)
t1.Draw()
t2.Draw()
c.Print("dataDS_200_dXdzdYdz.pdf")
c.Print("dataDS_200_dXdzdYdz_pq.jpg")

# ====================================================



t2 = TText(0.18,0.85,"Zero Abs., February 2016, MAUS v3.1.2")
t2.SetNDC(1)
t2.SetTextSize(0.03)
t2.SetTextFont(42)

c.Clear()
XY_10 = f1.Get("dataUSref_alltof_XY")
# XY_10.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.1.2")
XY_10.SetStats(0)
XY_10.SetTitle("")
# XY_10.SetMaximum(400)
XY_10.SetMinimum(10)
XY_10.GetXaxis().SetLabelSize(0.05)
XY_10.GetXaxis().SetTitleSize(0.05)
XY_10.GetYaxis().SetLabelSize(0.05)
XY_10.GetYaxis().SetTitleSize(0.05)
XY_10.Draw("colz")
fillcolour = TColor.GetColor(col1, col2, col3)
c.GetFrame().SetFillColor(fillcolour)
c.SetFrameFillColor(fillcolour)
# t1.Draw()
t2.Draw()
c.Print("dataUSref_200_alltof_XY.pdf")
c.Print("dataUSref_200_alltof_XY_pq.jpg")

c.Clear()
XY_11 = f1.Get("dataUSref_prerad_XY")
#XY_11.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.1.2")
XY_11.SetStats(0)
XY_11.SetTitle("")
# XY_11.SetMaximum(400)
XY_11.SetMinimum(2)
XY_11.GetXaxis().SetLabelSize(0.05)
XY_11.GetXaxis().SetTitleSize(0.05)
XY_11.GetYaxis().SetLabelSize(0.05)
XY_11.GetYaxis().SetTitleSize(0.05)
XY_11.Draw("colz")
fillcolour = TColor.GetColor(col1, col2, col3)
c.GetFrame().SetFillColor(fillcolour)
c.SetFrameFillColor(fillcolour)
# t1.Draw()
t2.Draw()
c.Print("dataUSref_200_prerad_XY.pdf")
c.Print("dataUSref_200_prerad_XY_pq.jpg")

c.Clear()
XY_12 = f1.Get("dataUSref_XY")
# XY_12.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.1.2")
XY_12.SetStats(0)
XY_12.SetTitle("")
# XY_12.SetMaximum(400)
XY_12.SetMinimum(1)
XY_12.GetXaxis().SetLabelSize(0.05)
XY_12.GetXaxis().SetTitleSize(0.05)
XY_12.GetYaxis().SetLabelSize(0.05)
XY_12.GetYaxis().SetTitleSize(0.05)
XY_12.Draw("colz")
fillcolour = TColor.GetColor(col1, col2, col3)
c.GetFrame().SetFillColor(fillcolour)
c.SetFrameFillColor(fillcolour)
# t1.Draw()
t2.Draw()
c.Print("dataUSref_200_XY.pdf")
c.Print("dataUSref_200_XY_pq.jpg")

c.Clear()
dXdzdYdz_10 = f1.Get("dataUSref_alltof_dXdzdYdz")
# dXdzdYdz_10.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.1.2")
dXdzdYdz_10.SetStats(0)
dXdzdYdz_10.SetTitle("")
# dXdzdYdz_10.SetMaximum(300)
dXdzdYdz_10.SetMinimum(10)
dXdzdYdz_10.GetXaxis().SetLabelSize(0.05)
dXdzdYdz_10.GetXaxis().SetTitleSize(0.05)
dXdzdYdz_10.GetYaxis().SetLabelSize(0.05)
dXdzdYdz_10.GetYaxis().SetTitleSize(0.05)
dXdzdYdz_10.GetXaxis().SetNdivisions(508)
dXdzdYdz_10.GetYaxis().SetNdivisions(508)
dXdzdYdz_10.Draw("colz")
fillcolour = TColor.GetColor(col1, col2, col3)
c.GetFrame().SetFillColor(fillcolour)
c.SetFrameFillColor(fillcolour)
# t1.Draw()
t2.Draw()
c.Print("dataUSref_200_alltof_dXdzdYdz.pdf")
c.Print("dataUSref_200_alltof_dXdzdYdz_pq.jpg")

c.Clear()
dXdzdYdz_11 = f1.Get("dataUSref_prerad_dXdzdYdz")
# dXdzdYdz_11.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.1.2")
dXdzdYdz_11.SetStats(0)
dXdzdYdz_11.SetTitle("")
# dXdzdYdz_11.SetMaximum(300)
dXdzdYdz_11.SetMinimum(2)
dXdzdYdz_11.GetXaxis().SetLabelSize(0.05)
dXdzdYdz_11.GetXaxis().SetTitleSize(0.05)
dXdzdYdz_11.GetYaxis().SetLabelSize(0.05)
dXdzdYdz_11.GetYaxis().SetTitleSize(0.05)
dXdzdYdz_11.GetXaxis().SetNdivisions(508)
dXdzdYdz_11.GetYaxis().SetNdivisions(508)
dXdzdYdz_11.Draw("colz")
fillcolour = TColor.GetColor(col1, col2, col3)
c.GetFrame().SetFillColor(fillcolour)
c.SetFrameFillColor(fillcolour)
# t1.Draw()
t2.Draw()
c.Print("dataUSref_200_prerad_dXdzdYdz.pdf")
c.Print("dataUSref_200_prerad_dXdzdYdz_pq.jpg")

c.Clear()
dXdzdYdz_12 = f1.Get("dataUSref_dXdzdYdz")
# dXdzdYdz_12.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.1.2")
dXdzdYdz_12.SetStats(0)
dXdzdYdz_12.SetTitle("")
# dXdzdYdz_12.SetMaximum(300)
dXdzdYdz_12.SetMinimum(0)
dXdzdYdz_12.GetXaxis().SetLabelSize(0.05)
dXdzdYdz_12.GetXaxis().SetTitleSize(0.05)
dXdzdYdz_12.GetYaxis().SetLabelSize(0.05)
dXdzdYdz_12.GetYaxis().SetTitleSize(0.05)
dXdzdYdz_12.GetXaxis().SetNdivisions(508)
dXdzdYdz_12.GetYaxis().SetNdivisions(508)
dXdzdYdz_12.Draw("colz")
fillcolour = TColor.GetColor(col1, col2, col3)
c.GetFrame().SetFillColor(fillcolour)
c.SetFrameFillColor(fillcolour)
# t1.Draw()
t2.Draw()
c.Print("dataUSref_200_dXdzdYdz.pdf")
c.Print("dataUSref_200_dXdzdYdz_pq.jpg")

# =====================================================


c.Clear()
XY_10 = f1.Get("dataDSref_alltof_XY")
# XY_10.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.1.2")
XY_10.SetStats(0)
XY_10.SetTitle("")
# XY_10.SetMaximum(400)
XY_10.SetMinimum(10)
XY_10.GetXaxis().SetLabelSize(0.05)
XY_10.GetXaxis().SetTitleSize(0.05)
XY_10.GetYaxis().SetLabelSize(0.05)
XY_10.GetYaxis().SetTitleSize(0.05)
XY_10.Draw("colz")
fillcolour = TColor.GetColor(col1, col2, col3)
c.GetFrame().SetFillColor(fillcolour)
c.SetFrameFillColor(fillcolour)
# t1.Draw()
t2.Draw()
c.Print("dataDSref_200_alltof_XY.pdf")
c.Print("dataDSref_200_alltof_XY_pq.jpg")

c.Clear()
XY_11 = f1.Get("dataDSref_prerad_XY")
#XY_11.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.1.2")
XY_11.SetStats(0)
XY_11.SetTitle("")
# XY_11.SetMaximum(400)
XY_11.SetMinimum(2)
XY_11.GetXaxis().SetLabelSize(0.05)
XY_11.GetXaxis().SetTitleSize(0.05)
XY_11.GetYaxis().SetLabelSize(0.05)
XY_11.GetYaxis().SetTitleSize(0.05)
XY_11.Draw("colz")
fillcolour = TColor.GetColor(col1, col2, col3)
c.GetFrame().SetFillColor(fillcolour)
c.SetFrameFillColor(fillcolour)
# t1.Draw()
t2.Draw()
c.Print("dataDSref_200_prerad_XY.pdf")
c.Print("dataDSref_200_prerad_XY_pq.jpg")

c.Clear()
XY_12 = f1.Get("dataDSref_XY")
# XY_12.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.1.2")
XY_12.SetStats(0)
XY_12.SetTitle("")
# XY_12.SetMaximum(400)
XY_12.SetMinimum(1)
XY_12.GetXaxis().SetLabelSize(0.05)
XY_12.GetXaxis().SetTitleSize(0.05)
XY_12.GetYaxis().SetLabelSize(0.05)
XY_12.GetYaxis().SetTitleSize(0.05)
XY_12.Draw("colz")
fillcolour = TColor.GetColor(col1, col2, col3)
c.GetFrame().SetFillColor(fillcolour)
c.SetFrameFillColor(fillcolour)
# t1.Draw()
t2.Draw()
c.Print("dataDSref_200_XY.pdf")
c.Print("dataDSref_200_XY_pq.jpg")

c.Clear()
dXdzdYdz_10 = f1.Get("dataDSref_alltof_dXdzdYdz")
# dXdzdYdz_10.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.1.2")
dXdzdYdz_10.SetStats(0)
dXdzdYdz_10.SetTitle("")
# dXdzdYdz_10.SetMaximum(300)
dXdzdYdz_10.SetMinimum(10)
dXdzdYdz_10.GetXaxis().SetLabelSize(0.05)
dXdzdYdz_10.GetXaxis().SetTitleSize(0.05)
dXdzdYdz_10.GetYaxis().SetLabelSize(0.05)
dXdzdYdz_10.GetYaxis().SetTitleSize(0.05)
dXdzdYdz_10.GetXaxis().SetNdivisions(508)
dXdzdYdz_10.GetYaxis().SetNdivisions(508)
dXdzdYdz_10.Draw("colz")
fillcolour = TColor.GetColor(col1, col2, col3)
c.GetFrame().SetFillColor(fillcolour)
c.SetFrameFillColor(fillcolour)
# t1.Draw()
t2.Draw()
c.Print("dataDSref_200_alltof_dXdzdYdz.pdf")
c.Print("dataDSref_200_alltof_dXdzdYdz_pq.jpg")

c.Clear()
dXdzdYdz_11 = f1.Get("dataDSref_prerad_dXdzdYdz")
# dXdzdYdz_11.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.1.2")
dXdzdYdz_11.SetStats(0)
dXdzdYdz_11.SetTitle("")
# dXdzdYdz_11.SetMaximum(300)
dXdzdYdz_11.SetMinimum(2)
dXdzdYdz_11.GetXaxis().SetLabelSize(0.05)
dXdzdYdz_11.GetXaxis().SetTitleSize(0.05)
dXdzdYdz_11.GetYaxis().SetLabelSize(0.05)
dXdzdYdz_11.GetYaxis().SetTitleSize(0.05)
dXdzdYdz_11.GetXaxis().SetNdivisions(508)
dXdzdYdz_11.GetYaxis().SetNdivisions(508)
dXdzdYdz_11.Draw("colz")
fillcolour = TColor.GetColor(col1, col2, col3)
c.GetFrame().SetFillColor(fillcolour)
c.SetFrameFillColor(fillcolour)
# t1.Draw()
t2.Draw()
c.Print("dataDSref_200_prerad_dXdzdYdz.pdf")
c.Print("dataDSref_200_prerad_dXdzdYdz_pq.jpg")

c.Clear()
dXdzdYdz_12 = f1.Get("dataDSref_dXdzdYdz")
# dXdzdYdz_12.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.1.2")
dXdzdYdz_12.SetStats(0)
dXdzdYdz_12.SetTitle("")
# dXdzdYdz_12.SetMaximum(300)
dXdzdYdz_12.SetMinimum(0)
dXdzdYdz_12.GetXaxis().SetLabelSize(0.05)
dXdzdYdz_12.GetXaxis().SetTitleSize(0.05)
dXdzdYdz_12.GetYaxis().SetLabelSize(0.05)
dXdzdYdz_12.GetYaxis().SetTitleSize(0.05)
dXdzdYdz_12.GetXaxis().SetNdivisions(508)
dXdzdYdz_12.GetYaxis().SetNdivisions(508)
dXdzdYdz_12.Draw("colz")
fillcolour = TColor.GetColor(col1, col2, col3)
c.GetFrame().SetFillColor(fillcolour)
c.SetFrameFillColor(fillcolour)
# t1.Draw()
t2.Draw()
c.Print("dataDSref_200_dXdzdYdz.pdf")
c.Print("dataDSref_200_dXdzdYdz_pq.jpg")

c.Clear()
hgoldmirrorl = f1.Get("hgoldmirrorl")
hgoldmirrorr = f1.Get("hgoldmirrorr")
hgoldmirrorl.SetStats(0)
hgoldmirrorl.SetTitle("")
hgoldmirrorl.SetMinimum(0)
hgoldmirrorl.GetXaxis().SetLabelSize(0.05)
hgoldmirrorl.GetXaxis().SetTitleSize(0.05)
hgoldmirrorl.GetYaxis().SetLabelSize(0.05)
hgoldmirrorl.GetYaxis().SetTitleSize(0.05)
hgoldmirrorl.GetXaxis().SetNdivisions(508)
hgoldmirrorl.GetYaxis().SetNdivisions(508)
hgoldmirrorr.SetLineColor(2)
hgoldmirrorr.Draw()
hgoldmirrorl.Draw("SAME")
# t1.Draw()
t2.Draw()
c.Print("mirrorgold.pdf")
c.Print("mirrorgold_pq.jpg")

morehist = ["projposUSDSdiff_GEANT",
            "thetaXUS_thetaXDSGEANT"]

for hist in morehist:
    c.Clear()
    h = f1.Get(hist)
    print hist
    # h.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.1.2")
    h.SetStats(0)
    h.SetTitle("")
    # h.SetMaximum(300)
    h.SetMinimum(0)
    h.GetXaxis().SetLabelSize(0.05)
    h.GetXaxis().SetTitleSize(0.05)
    h.GetYaxis().SetLabelSize(0.05)
    h.GetYaxis().SetTitleSize(0.05)
    h.GetXaxis().SetNdivisions(508)
    h.GetYaxis().SetNdivisions(508)
    h.Draw("colz")
    # t1.Draw()
    t2.Draw()
    c.Print(hist + "_200.pdf")
    c.Print(hist + "_200_pq.jpg")



# if __name__ == '__main__':


