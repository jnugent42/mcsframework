import ROOT
from ROOT import TH1D, TH2D, TCanvas, TLegend, TFile, TText, TLine, TArrow, TROOT
import numpy

TROOT.gROOT.SetBatch(1)

stops = [0.0000, 0.1250, 0.2500, 0.3750, 0.5000, 0.6250, 0.7500, 0.8750, 1.0000]
red   = [0.2082, 0.0592, 0.0780, 0.0232, 0.1802, 0.5301, 0.8186, 0.9956, 0.9764]
green = [0.1664, 0.3599, 0.5041, 0.6419, 0.7178, 0.7492, 0.7328, 0.7862, 0.9832]
blue  = [0.5293, 0.8684, 0.8385, 0.7914, 0.6425, 0.4662, 0.3499, 0.1968, 0.0539]
s = numpy.array(stops)
r = numpy.array(red)
g = numpy.array(green)
b = numpy.array(blue)
ncontours = 255
npoints = len(s)
ROOT.TColor.CreateGradientColorTable(npoints, s, r, g, b, ncontours)
ROOT.gStyle.SetNumberContours(ncontours)
# axes and labels
ROOT.gStyle.SetPadBottomMargin(0.15)
ROOT.gStyle.SetPadLeftMargin(0.15)
ROOT.gStyle.SetPadRightMargin(0.15)
for axis in "X", "Y":
    ROOT.gStyle.SetNdivisions(505, axis)
    ROOT.gStyle.SetLabelSize(0.05, axis)
    ROOT.gStyle.SetTitleSize(0.06, axis)
    ROOT.gStyle.SetTitleOffset(1.10, axis)
level=0.9
ROOT.TColor.GetColor(0.2082*level, 0.1664*level, 0.5293*level)

f0 = TFile("../lih172/LihMuon_03172.root")
f1 = TFile("../lih200/LihMuon_03200.root")
f2 = TFile("../lih240/LihMuon_03240.root")
#f3 = TFile("XePion_03240.root")
f1misalign = TFile("../lihmisalign/LihMuon_03200.root")

fMC0 = TFile("../MClih172/LihMuon_03172.root")
fMC1 = TFile("../MClih200/LihMuon_03200.root")
# fMC1 = TFile("../effi_scan/effi_0/LiHMu_3200_12.root")
fMC2 = TFile("../MClih240/LihMuon_03240.root")
#fMC1 = TFile("/data/neutrino03/jnugent/dipolescaling/DSmaus/redouput/analyse_output/LihMuon_03200.root")

# fz0 = TFile("../ZeroMuon_3172.root")
# fz1 = TFile("../ZeroMuon_03200_LiHMC.root")
# fz2 = TFile("../ZeroMuon_03240_LiHMC.root")

hdiffradius0 = f0.Get("diffradius")
hdiffradius1 = f1.Get("diffradius")
hdiffradius2 = f2.Get("diffradius")

hprojradius0 = f0.Get("projradius")
hprojradius1 = f1.Get("projradius")
hprojradius2 = f2.Get("projradius")

htrackno0 = f0.Get("trackno")
htrackno1 = f1.Get("trackno")
htrackno2 = f2.Get("trackno")

#hMCdiffradius0 = fMC0.Get("diffradius")
hMCdiffradius1 = fMC1.Get("diffradius")
#hMCdiffradius2 = fMC2.Get("diffradius")

#hMCprojradius0 = fMC0.Get("projradius")
hMCprojradius1 = fMC1.Get("projradius")
#hMcprojradius2 = fMC2.Get("projradius")

#hMCtrackno0 = fMC0.Get("trackno")
hMCtrackno1 = fMC1.Get("trackno")
#hMCtrackno2 = fMC2.Get("trackno")

h0 = f0.Get("thetaX_data")
h1 = f1.Get("thetaX_data")
h2 = f2.Get("thetaX_data")
hMC1 = fMC1.Get("thetaX_data")
#h3 = f3.Get("thetaX_data")

hy0 = f0.Get("thetaY_data")
hy1 = f1.Get("thetaY_data")
hy2 = f2.Get("thetaY_data")
hMCy1 = fMC1.Get("thetaY_data")

hScatt0 = f0.Get("thetaScatt_data")
hScatt1 = f1.Get("thetaScatt_data")
hScatt2 = f2.Get("thetaScatt_data")
hMCScatt1 = fMC1.Get("thetaScatt_data")

h1empty = f1.Get("thetaX_ref")
hMC1empty = fMC1.Get("thetaX_ref")
hy1empty = f1.Get("thetaY_ref")
hMCy1empty = fMC1.Get("thetaY_ref")

hyz0 = f0.Get("thetaY_ref")
hyz1 = f1.Get("thetaY_ref")
hyz2 = f2.Get("thetaY_ref")

hz0 = f0.Get("thetaX_ref")
hz1 = f1.Get("thetaX_ref")
hz2 = f2.Get("thetaX_ref")
#hz3 = f3.Get("thetaX_ref")

ht0 = f0.Get("thetaX_GEANT")
ht1 = f1.Get("thetaX_GEANT")
ht2 = f2.Get("thetaX_GEANT")
#ht3 = f3.Get("thetaX_truthsim")

hrg0 = f0.Get("thetaY_recoGEANT")
hrg1 = f1.Get("thetaY_recoGEANT")
hrg2 = f2.Get("thetaY_recoGEANT")

hm0 = f0.Get("thetaX_Moliere")
hm1 = f1.Get("thetaX_Moliere")
hm2 = f2.Get("thetaX_Moliere")
#hm3 = f3.Get("thetaX_truthsim")

hc0 = f0.Get("thetaX_Cobb")
hc1 = f1.Get("thetaX_Cobb")
hc2 = f2.Get("thetaX_Cobb")
#hc3 = f3.Get("thetaX_Cobb")

h20 = f0.Get("dataUS_XY")
h21 = f1.Get("dataUS_XY")
h22 = f2.Get("dataUS_XY")

h21ref = f1.Get("dataUSref_XY")
h21refx = h21ref.ProjectionX("h21refx")
h21refy = h21ref.ProjectionX("h21refy")

h20x = h20.ProjectionX("h20x")
h21x = h21.ProjectionX("h21x")
h22x = h22.ProjectionX("h22x")

h20y = h20.ProjectionY("h20y")
h21y = h21.ProjectionY("h21y")
h22y = h22.ProjectionY("h22y")

h20DS = f0.Get("dataDS_XY")
h21DS = f1.Get("dataDS_XY")
h22DS = f2.Get("dataDS_XY")

h20DSx = h20DS.ProjectionX("h20DSx")
h21DSx = h21DS.ProjectionX("h21DSx")
h22DSx = h22DS.ProjectionX("h22DSx")

h20DSy = h20DS.ProjectionY("h20DSy")
h21DSy = h21DS.ProjectionY("h21DSy")
h22DSy = h22DS.ProjectionY("h22DSy")

h23 = f0.Get("dataUS_dXdzdYdz")
h24 = f1.Get("dataUS_dXdzdYdz")
h25 = f2.Get("dataUS_dXdzdYdz")

hDS23 = f0.Get("dataDS_dXdzdYdz")
hDS24 = f1.Get("dataDS_dXdzdYdz")
hDS25 = f2.Get("dataDS_dXdzdYdz")

h23x = h23.ProjectionX("h23x")
h24x = h24.ProjectionX("h24x")
h25x = h25.ProjectionX("h25x")

h24misalign = f1misalign.Get("dataUS_dXdzdYdz")
h24xmisalign = h24misalign.ProjectionX("h24xmisalign")

h23y = h23.ProjectionY("h23y")
h24y = h24.ProjectionY("h24y")
h25y = h25.ProjectionY("h25y")

h24ymisalign = h24misalign.ProjectionY("h24ymisalign")

hDS23x = hDS23.ProjectionX("hDS23x")
hDS24x = hDS24.ProjectionX("hDS24x")
hDS25x = hDS25.ProjectionX("hDS25x")

hDS23y = hDS23.ProjectionY("hDS23y")
hDS24y = hDS24.ProjectionY("hDS24y")
hDS25y = hDS25.ProjectionY("hDS25y")
#m23 = fMC0.Get("dataUS_dXdzdYdz")
m24 = fMC1.Get("dataUS_dXdzdYdz")
mDS24 = fMC1.Get("dataDS_dXdzdYdz")
#m25 = fMC2.Get("dataUS_dXdzdYdz")

#m23x = m23.ProjectionX("m23x")
m24x = m24.ProjectionX("m24x")
#m25x = m25.ProjectionX("m25x")

#m23y = m23.ProjectionY("m23y")
m24y = m24.ProjectionY("m24y")
m24ymisalign = m24y
mDS24y = mDS24.ProjectionY("mDS24y")
#m25y = m25.ProjectionY("m25y")

#m20 = fMC0.Get("dataUS_XY")
m21 = fMC1.Get("dataUS_XY")
#m22 = fMC2.Get("dataUS_XY")

#m20x = m20.ProjectionX("m20x")
m21x = m21.ProjectionX("m21x")
#m22x = m22.ProjectionX("m22x")

m21ref = f1.Get("dataUSref_XY")
m21refx = m21ref.ProjectionX("m21refx")
m21refy = m21ref.ProjectionX("m21refy")
#m20y = m20.ProjectionY("m20y")
m21y = m21.ProjectionY("m21y")
#m22y = m22.ProjectionY("m22y")

h21_pz = f1.Get("LiH_mom")
h212_pz = f1.Get("empty_mom")
m21_pz = fMC1.Get("LiH_mom")
h22_pz = f0.Get("LiH_mom")
m22_pz = fMC0.Get("LiH_mom")
h23_pz = f2.Get("LiH_mom")
m23_pz = fMC2.Get("LiH_mom")

href172_pz = f0.Get("empty_mom")
href200_pz = f1.Get("empty_mom")
href240_pz = f2.Get("empty_mom")

t1 = TText(0.6,0.885,"MICE Internal")
t3 = TText(0.6,0.85,"ISIS cycle 2015/04")
t2 = TText(0.6,0.815,"LiH, MAUS v3.3.2")
t1.SetNDC(1)
t1.SetTextSize(0.04)
t1.SetTextFont(42)
t2.SetNDC(1)
t2.SetTextSize(0.03)
t2.SetTextFont(42)
t3.SetNDC(1)
t3.SetTextSize(0.03)
t3.SetTextFont(42)

c = TCanvas("c","Scattering")
c.SetLogy(0)
c.SetBottomMargin(0.125)
c.SetLeftMargin(0.15)
c.SetTopMargin(0.07)
c.SetRightMargin(0.05)
leg = TLegend(0.7,0.7,0.99,0.99)
leg.SetLineColor(10)
hScatt1.SetTitle(";#theta_{Scatt} (radians);Probability per mrad")
binwidth = hScatt1.GetXaxis().GetBinWidth(50)
print binwidth

hScatt1.Sumw2()
hScatt1.Scale(0.001/binwidth)
hScatt1.SetLineColor(2)
hScatt1.SetLineStyle(5)
hScatt1.SetMarkerColor(2)
hScatt1.SetMarkerStyle(25)
hScatt1.SetLineWidth(2)
m = hScatt1.GetEntries()
hScatt1.Scale(1./m)
hScatt1.Rebin(1)
leg.AddEntry(hScatt1,"200 MeV/c","p")
hScatt1.Draw("pesame")

hMCScatt1.Sumw2()
hMCScatt1.Scale(0.001/binwidth)
hMCScatt1.SetLineColor(1)
hMCScatt1.SetLineStyle(1)
hMCScatt1.SetLineColor(1)
# hMCScatt1.SetMarkerStScattle(22)
hMCScatt1.SetLineWidth(2)
hMCScatt1.SetMarkerColor(1)
hMCScatt1.SetMarkerStyle(26)
q = hMCScatt1.GetEntries()
hMCScatt1.Scale(1./q)
hMCScatt1.Rebin(1)
leg.AddEntry(hMCScatt1,"240 MeV/c","p")
hMCScatt1.Draw("pesame")
t1.Draw()
t2.Draw()

#leg.Draw("same")
c.Print("MCData_thetaScatt.pdf")
c.Print("MCData_thetaScatt_pq.jpg")

c.Clear()
leg.Clear()
leg = TLegend(0.7,0.7,0.99,0.99)
leg.SetLineColor(10)
hyz0.Sumw2()
hyz0.SetLineColor(4)
hyz0.SetLineStyle(9)
hyz0.SetLineWidth(2)
hyz0.SetMarkerColor(4)
hyz0.SetMarkerStyle(20)
hyz0.SetStats(0)
hyz0.Sumw2()
nyz = hyz0.GetEntries()
hyz0.Scale(1./nyz)
hyz0.Rebin(1)
hyz0.GetXaxis().SetRangeUser(-0.06,0.06)
# hz0.SetMaximum(0.2)
#
print hyz0.GetXaxis().GetBinWidth(20)
leg.AddEntry(hyz0,"172 MeV/c","p")
hyz0.SetTitle(";#theta_{Y} (radians);Probability per mrad")
binwidth = hyz0.GetXaxis().GetBinWidth(50)
print binwidth
# hyz0.Scale(0.001/binwidth)
hyz0.GetYaxis().SetRangeUser(5e-6,0.20)
#hyz0.GetXaxis().SetLabelSize(0.05)
#hyz0.GetXaxis().SetTitleSize(0.05)
#hyz0.GetYaxis().SetLabelSize(0.05)
#hyz0.GetYaxis().SetTitleSize(0.05)
#hyz0.GetYaxis().SetTitleOffset(1.5)
hyz0*3
hyz0.GetXaxis().SetRangeUser(-0.0465,0.0465)
hyz0.Draw("e1 p")

hyz1.Sumw2()
# hyz1.Scale(0.001/binwidth)
hyz1.SetLineColor(2)
hyz1.SetLineStyle(5)
hyz1.SetLineWidth(2)
hyz1.SetMarkerColor(2)
hyz1.SetMarkerStyle(25)
myz = hyz1.GetEntries()
hyz1.Scale(1./myz)
hyz1.Rebin(1)
leg.AddEntry(hyz1,"200 MeV/c","p")
hyz1*3
hyz1.GetXaxis().SetRangeUser(-0.0465,0.0465)
hyz1.Draw("e1 p same")
# hyz1.Draw("e1 p")

hyz2.Sumw2()
# hyz2.Scale(0.001/binwidth)
hyz2.SetLineColor(1)
hyz2.SetLineStyle(1)
hyz2.SetLineWidth(2)
hyz2.SetMarkerColor(1)
hyz2.SetMarkerStyle(26)
qyz = hyz2.GetEntries()
hyz2.Scale(1./qyz)
hyz2.Rebin(1)
leg.AddEntry(hyz2,"240 MeV/c","p")
hyz2*3
hyz2.GetXaxis().SetRangeUser(-0.0465,0.0465)
hyz2.Draw("e1 p same")

t6 = TText(0.18,0.85,"Zero Abs., Muon Beams, MAUS v3.3.2")
t6.SetNDC(1)
t6.SetTextSize(0.03)
t6.SetTextFont(42)
t1.Draw()
t6.Draw()
leg.Draw("same")
c.Print("Empty_Raw_Combinedy.pdf")
c.Print("Empty_Raw_Combinedy_pq.jpg")
leg.Clear()
#t1 = TText(0.18,0.885,"MICE Internal ISIS cycle 2015/04")
#t2 = TText(0.18,0.85,"LiH, MAUS v3.3.2")
#t1.SetNDC(1)
#t1.SetTextSize(0.04)
#t1.SetTextFont(42)
#t2.SetNDC(1)
#t2.SetTextSize(0.03)
#t2.SetTextFont(42)

c.Clear()
#c.SetLogy()
leg = TLegend(0.7,0.7,0.99,0.99)
leg.SetLineColor(10)
hz0.SetLineColor(4)
hz0.SetLineStyle(9)
hz0.SetLineWidth(2)
hz0.SetMarkerColor(4)
hz0.SetMarkerStyle(20)
hz0.SetStats(0)
hz0.Sumw2()
binwidth = hz0.GetXaxis().GetBinWidth(50)
# hz0.Scale(0.001/binwidth)
nz = hz0.GetEntries()
print 'nz',nz
hz0.Scale(1./nz)
hz0.Rebin(1)
hz0.GetXaxis().SetRangeUser(-0.06,0.06)
hz0.SetMaximum(0.2)

print hz0.GetXaxis().GetBinWidth(20)
leg.AddEntry(hz0,"172 MeV/c","p")
hz0.SetTitle(";Deltatheta_{X} (radians);Probability per 3 mrad")

print binwidth
hz0.GetYaxis().SetRangeUser(5e-6,0.20)
#hz0.GetXaxis().SetLabelSize(0.05)
#hz0.GetXaxis().SetTitleSize(0.05)
#hz0.GetYaxis().SetLabelSize(0.05)
#hz0.GetYaxis().SetTitleSize(0.05)
#hz0.GetYaxis().SetTitleOffset(1.5)
hz0.GetXaxis().SetRangeUser(-0.0465,0.0465)
hz0.Draw("e1 p")

hz1.Sumw2()
# hz1.Scale(0.001/binwidth)
hz1.SetLineColor(2)
hz1.SetLineStyle(5)
hz1.SetLineWidth(2)
hz1.SetMarkerColor(2)
hz1.SetMarkerStyle(25)
mz = hz1.GetEntries()
print 'mz',mz
hz1.Scale(1./mz)
hz1.Rebin(1)
leg.AddEntry(hz1,"200 MeV/c","p")
hz1.GetXaxis().SetRangeUser(-0.0465,0.0465)
hz1.Draw("e1 p same")

hz2.Sumw2()
# hz2.Scale(0.001/binwidth)
hz2.SetLineColor(1)
hz2.SetLineStyle(1)
hz2.SetLineWidth(2)
hz2.SetMarkerColor(1)
hz2.SetMarkerStyle(26)
qz = hz2.GetEntries()
print 'qz',qz
hz2.Scale(1./qz)
hz2.Rebin(1)
leg.AddEntry(hz2,"240 MeV/c","p")
hz2.GetXaxis().SetRangeUser(-0.0465,0.0465)
hz2.Draw("e1 p same")

t6 = TText(0.18,0.85,"Zero Abs., Muon Beams, MAUS v3.3.2")
t6.SetNDC(1)
t6.SetTextSize(0.03)
t6.SetTextFont(42)
t1.Draw()
t6.Draw()
leg.Draw("same")
c.Print("Empty_Raw_Combined.pdf")
c.Print("Empty_Raw_Combined_pq.jpg")
leg.Clear()
c = TCanvas("c","Scattering")
c.SetLogy(0)
c.SetBottomMargin(0.125)
c.SetLeftMargin(0.15)
c.SetTopMargin(0.07)
c.SetRightMargin(0.05)
leg = TLegend(0.7,0.7,0.99,0.99)
leg.SetLineColor(10)
hy1empty.SetTitle(";#theta_{Y} (radians);Probability per mrad")
binwidth = hy1empty.GetXaxis().GetBinWidth(50)
print binwidth

hy1empty.Sumw2()
# hy1empty.Scale(0.001/binwidth)
hy1empty.SetMarkerStyle(20)
hy1empty.SetMarkerColor(ROOT.kBlack)
hy1empty.SetLineColor(ROOT.kBlack)
m = hy1empty.GetEntries()
# hy1empty.Scale(1./m)
hy1empty.Rebin(1)
leg.AddEntry(hy1empty,"200 MeV/c","p")


#hMCy1.Sumw2()
hMCy1empty.SetFillColor(ROOT.kOrange-2)
hMCy1empty.SetTitle("")
hMCy1empty.SetStats(0)
# hMCy1empty.Scale(0.001/binwidth)
q = hMCy1empty.GetEntries()
hMCy1empty.Scale(1./q)
hMCy1empty.Rebin(1)
leg.AddEntry(hMCy1empty,"240 MeV/c","p")
hMCy1empty*3
hy1empty*3
hMCy1empty.GetXaxis().SetRangeUser(-0.0465,0.0465)
hy1empty.GetYaxis().SetRangeUser(0.0,0.2)
hMCy1empty.GetYaxis().SetRangeUser(0.0,0.2)
hMCy1empty.Draw()
hy1empty.GetXaxis().SetRangeUser(-0.0465,0.0465)
hy1empty.Draw("e1 p same")
t1.Draw()
t2.Draw()

#leg.Draw("same")
c.Print("MCData_thetaY_ref.pdf")
c.Print("MCData_thetaY_ref_pq.jpg")

#t1 = TText(0.18,0.885,"MICE Internal ISIS cycle 2015/04")
#t2 = TText(0.18,0.85,"LiH, MAUS v3.3.2")
#t1.SetNDC(1)
#t1.SetTextSize(0.04)
#t1.SetTextFont(42)
#t2.SetNDC(1)
#t2.SetTextSize(0.03)
#t2.SetTextFont(42)

c = TCanvas("c","Scattering")
c.SetLogy(0)
c.SetBottomMargin(0.125)
c.SetLeftMargin(0.15)
c.SetTopMargin(0.07)
c.SetRightMargin(0.05)
leg = TLegend(0.7,0.7,0.99,0.99)
leg.SetLineColor(10)
h1empty.SetTitle(";#theta_{X} (radians);Probability per mrad")
binwidth = h1empty.GetXaxis().GetBinWidth(50)
print binwidth

h1empty.Sumw2()
# h1empty.Scale(0.001/binwidth)
h1empty.SetStats(0)
h1empty.SetTitle("")
h1empty.SetMarkerStyle(20)
h1empty.SetMarkerColor(ROOT.kBlack)
h1empty.SetLineColor(ROOT.kBlack)
m = h1empty.GetEntries()
# h1empty.Scale(1./m)
h1empty.Rebin(1)
leg.AddEntry(h1empty,"200 MeV/c","p")

hMC1empty.SetStats(0)
# hMC1empty.Scale(0.001/binwidth)
q = hMC1empty.GetEntries()
hMC1empty.Scale(1./q)
hMC1empty.Rebin(1)
leg.AddEntry(hMC1empty,"240 MeV/c","p")
hMC1empty.SetFillColor(ROOT.kOrange-2)
hMC1empty.GetXaxis().SetRangeUser(-0.0465,0.0465)
h1empty.GetYaxis().SetRangeUser(0.0,0.2)
hMC1empty.GetYaxis().SetRangeUser(0.0,0.2)
hMC1empty.Draw()
c.Update()
h1empty.GetXaxis().SetRangeUser(-0.0465,0.0465)
h1empty.Draw("e1 p same")
t1.Draw()
t2.Draw()

leg.Draw("same")
c.Print("MCData_thetaX_ref.pdf")
c.Print("MCData_thetaX_ref_pq.jpg")

c = TCanvas("c","Scattering")
c.SetLogy(0)
c.SetBottomMargin(0.125)
c.SetLeftMargin(0.15)
c.SetTopMargin(0.07)
c.SetRightMargin(0.05)
leg = TLegend(0.7,0.7,0.99,0.99)
leg.SetLineColor(10)
hy1.SetTitle(";#theta_{y} (radians);Probability per 3 mrad")
binwidth = hy1.GetXaxis().GetBinWidth(50)
print binwidth

hy1.Sumw2()
# hy1.Scale(0.001/binwidth)
hy1.SetMarkerStyle(20)
m = hy1.GetEntries()
hy1.Scale(1./m)
hy1.Rebin(1)
leg.AddEntry(hy1,"200 MeV/c","p")


# hMCy1.Sumw2()
hMCy1.SetFillColor(ROOT.kOrange-2)
hMCy1.SetTitle("")
hMCy1.SetTitle(";#theta_{y} (radians);Probability per 3 mrad")
hMCy1.SetStats(0)
# hMCy1.Scale(0.001/binwidth)
q = hMCy1.GetEntries()
hMCy1.Scale(1./q)
hMCy1.Rebin(1)
leg.AddEntry(hMCy1,"240 MeV/c","p")
hMCy1.GetXaxis().SetRangeUser(-0.0465,0.0465)
hMCy1.Draw()
hy1.GetXaxis().SetRangeUser(-0.0465,0.0465)
hy1.Draw("e1 p same")
t1.Draw()
t2.Draw()

chi2thetaY=hMCy1.Chi2Test(hy1, "CHI2/NDF")
chi2calc=0
print "chi calc"
for i in range(1,48):
    hy1val=hy1.GetBinContent(i)
    hMCy1val=hMCy1.GetBinContent(i)
    chiint=float(hy1val-hMCy1val)
    error=hy1.GetBinError(i)
    print i
    print chiint*chiint
    print error
    if error>0:
        chi2calc+=chiint*chiint/error
        print chi2calc
#leg.Draw("same")
#t4 = TText(0.18,0.785,"chi^2/NDF="+str("{:.2f}".format(chi2calc)))
#t4 = TText(0.18,0.785,"chi^2/NDF="+str((chi2calc)))
#t4.SetNDC(1)
# t4.Draw()
#leg.Draw("same")
c.Print("MCData_thetaY.pdf")
c.Print("MCData_thetaY_pq.jpg")

#t1 = TText(0.18,0.885,"MICE Internal ISIS cycle 2015/04")
#t2 = TText(0.18,0.85,"LiH, MAUS v3.3.2")
#t1.SetNDC(1)
#t1.SetTextSize(0.04)
#t1.SetTextFont(42)
#t2.SetNDC(1)
#t2.SetTextSize(0.03)
#t2.SetTextFont(42)

c = TCanvas("c","Scattering")
c.SetLogy(0)
c.SetBottomMargin(0.125)
c.SetLeftMargin(0.15)
c.SetTopMargin(0.07)
c.SetRightMargin(0.05)
leg = TLegend(0.7,0.7,0.99,0.99)
leg.SetLineColor(10)
h1.SetTitle(";#theta_{x} (radians);Probability per 3 mrad")
binwidth = h1.GetXaxis().GetBinWidth(50)
print binwidth

h1.Sumw2()
# h1.Scale(0.001/binwidth)
h1.SetStats(0)
h1.SetTitle("")
h1.SetMarkerStyle(20)
m = h1.GetEntries()
h1.Scale(1./m)
h1.Rebin(1)
leg.AddEntry(h1,"200 MeV/c","p")

hMC1.SetStats(0)
# hMC1.Scale(0.001/binwidth)
hMC1.SetTitle(";#theta_{x} (radians);Probability per 3 mrad")
q = hMC1.GetEntries()
hMC1.Scale(1./q)
hMC1.Rebin(1)
leg.AddEntry(hMC1,"240 MeV/c","p")
hMC1.SetFillColor(ROOT.kOrange-2)
hMC1.GetXaxis().SetRangeUser(-0.0465,0.0465)
hMC1.Draw()
c.Update()
h1.GetXaxis().SetRangeUser(-0.0465,0.0465)
h1.Draw("e1 p same")
t1.Draw()
t2.Draw()

chi2thetaX=hMC1.Chi2Test(h1, "CHI2/NDF")
#leg.Draw("same")
#t3 = TText(0.18,0.785,"chi^2/NDF="+str("{:.2f}".format(chi2thetaX)))
#t3.SetNDC(1)
# t3.Draw()
c.Print("MCData_thetaX.pdf")
c.Print("MCData_thetaX_pq.jpg")


#t1 = TText(0.18,0.885,"MICE Internal ISIS cycle 2015/04")
#t2 = TText(0.18,0.85,"LiH, MAUS v3.3.2")
#t1.SetNDC(1)
#t1.SetTextSize(0.04)
#t1.SetTextFont(42)
#t2.SetNDC(1)
#t2.SetTextSize(0.03)
#t2.SetTextFont(42)

c = TCanvas("c","Scattering")
c.SetLogy(0)
c.SetBottomMargin(0.125)
c.SetLeftMargin(0.15)
c.SetTopMargin(0.07)
c.SetRightMargin(0.05)
leg = TLegend(0.7,0.7,0.99,0.99)
leg.SetLineColor(10)
h0.SetLineColor(4)
h0.SetMarkerColor(4)
h0.SetLineStyle(9)
h0.SetMarkerStyle(20)
h0.SetLineWidth(2)

h0.Sumw2()
n = h0.GetEntries()
#h0.Scale(1./n)
h0.SetStats(0)
h0.Rebin(1)
print h0.GetXaxis().GetBinWidth(20)
leg.AddEntry(h0,"172 MeV/c","p")
h0.SetTitle(";#theta_{X} (radians);Probability per mrad")
binwidth = h0.GetXaxis().GetBinWidth(50)
print binwidth
#h0.Scale(0.001/binwidth)
#h0.GetYaxis().SetTitleOffset(1.05)
#h0.GetXaxis().SetRangeUser(-0.06,0.06)
#h0.GetYaxis().SetRangeUser(5e-6,0.03)
#h0.GetXaxis().SetLabelSize(0.05)
#h0.GetXaxis().SetTitleSize(0.05)
#h0.GetYaxis().SetLabelSize(0.05)
#h0.GetYaxis().SetTitleSize(0.05)
#h0.GetYaxis().SetTitleOffset(1.5)
#h0.Draw("pe")

h1ref = f1.Get("thetaX_data")
h1ref.Sumw2()
#h1ref.Scale(0.001/binwidth)
h1ref.SetLineColor(2)
h1ref.SetLineStyle(5)
h1ref.SetMarkerColor(2)
h1ref.SetMarkerStyle(25)
h1ref.SetLineWidth(2)
m = h1ref.GetEntries()
#h1ref.Scale(1./m)
h1ref.Rebin(1)
leg.AddEntry(h1ref,"200 MeV/c","p")
h1ref.Draw("pesame")

h2.Sumw2()
#h2.Scale(0.001/binwidth)
h2.SetLineColor(1)
h2.SetLineStyle(1)
h2.SetLineColor(1)
# h2.SetMarkerStyle(22)
h2.SetLineWidth(2)
h2.SetMarkerColor(1)
h2.SetMarkerStyle(26)
q = h2.GetEntries()
#h2.Scale(1./q)
h2.Rebin(1)
leg.AddEntry(h2,"240 MeV/c","p")
#h2.Draw("pesame")
t1.Draw()
t2.Draw()

leg.Draw("same")
h0.GetYaxis().SetRangeUser(0,0.03)
c.Print("LiH_Raw_Combined.pdf")
c.Print("LiH_Raw_Combined_pq.jpg")

c = TCanvas("c","Scattering")
c.SetLogy(0)
c.SetBottomMargin(0.125)
c.SetLeftMargin(0.15)
c.SetTopMargin(0.07)
c.SetRightMargin(0.05)
leg = TLegend(0.7,0.7,0.99,0.99)
leg.SetLineColor(10)
hy0.SetLineColor(4)
hy0.SetMarkerColor(4)
hy0.SetLineStyle(9)
hy0.SetMarkerStyle(20)
hy0.SetLineWidth(2)

hy0.Sumw2()
ny = hy0.GetEntries()
hy0.Scale(1./ny)
hy0.SetStats(0)
hy0.Rebin(1)
print hy0.GetXaxis().GetBinWidth(20)
leg.AddEntry(hy0,"172 MeV/c","p")
hy0.SetTitle(";#theta_{Y} (radians);Probability per mrad")
binwidth = hy0.GetXaxis().GetBinWidth(50)
print binwidth
hy0.Scale(0.001/binwidth)
#hy0.GetYaxis().SetTitleOffset(1.05)
#hy0.GetXaxis().SetRangeUser(-0.06,0.06)
#hy0.GetYaxis().SetRangeUser(0,0.08)
#hy0.GetXaxis().SetLabelSize(0.05)
#hy0.GetXaxis().SetTitleSize(0.05)
#hy0.GetYaxis().SetLabelSize(0.05)
#hy0.GetYaxis().SetTitleSize(0.05)
#hy0.GetYaxis().SetTitleOffset(1.5)
#hy0n = hy0.GetEntries()
#hy0.Scale(1./hy0n)
#hy0.GetYaxis().SetRangeUser(5e-6,0.08)
hy0.Draw("pe")

hy1.Sumw2()
hy1.Scale(0.001/binwidth)
hy1.SetLineColor(2)
hy1.SetLineStyle(5)
hy1.SetMarkerColor(2)
hy1.SetMarkerStyle(25)
hy1.SetLineWidth(2)
my = hy1.GetEntries()
hy1.Scale(1./my)
hy1.Rebin(1)
hy1.GetYaxis().SetRangeUser(5e-6,0.08)
leg.AddEntry(hy1,"200 MeV/c","p")
hy1.Draw("pesame")

hy2.Sumw2()
hy2.Scale(0.001/binwidth)
hy2.SetLineColor(1)
hy2.SetLineStyle(1)
hy2.SetLineColor(1)
#h2.SetMarkerStyle(22)
hy2.SetLineWidth(2)
hy2.SetMarkerColor(1)
hy2.SetMarkerStyle(26)
qy = hy2.GetEntries()
hy2.Scale(1./qy)
hy2.Rebin(1)
leg.AddEntry(hy2,"240 MeV/c","p")
hy2.GetYaxis().SetRangeUser(5e-6,0.08)
hy2.Draw("pesame")
t1.Draw()
t2.Draw()

leg.Draw("same")

c.Print("LiH_Raw_Combinedy.pdf")
c.Print("LiH_Raw_Combinedy_pq.jpg")

c.Clear()
c.SetLogy(0)
c.SetBottomMargin(0.125)
c.SetLeftMargin(0.15)
c.SetTopMargin(0.07)
c.SetRightMargin(0.05)
leg = TLegend(0.60,0.60,0.925,0.925)
leg.SetLineColor(10)
hdiffradius1.SetMarkerStyle(20)

hdiffradius1.Sumw2()
n = hdiffradius1.GetEntries()
hdiffradius1.SetStats(0)
hMCdiffradius1.SetStats(0)
hdiffradius1.Scale(1./n)
hdiffradius1.SetStats(0)
hdiffradius1.Rebin(10)
print hdiffradius1.GetXaxis().GetBinWidth(20)
leg.AddEntry(hdiffradius1,"200 MeV/c Data","p")
hdiffradius1.SetTitle(";radius (mm);No. of events")
hMCdiffradius1.SetTitle(";radius (mm);No. of events")
binwidth = hdiffradius1.GetXaxis().GetBinWidth(50)
print binwidth
hdiffradius1.Scale(0.001/binwidth)
#hdiffradius1.GetYaxis().SetTitleOffset(1.05)

#hdiffradius1.GetXaxis().SetLabelSize(0.05)
#hdiffradius1.GetXaxis().SetTitleSize(0.05)
#hdiffradius1.GetYaxis().SetLabelSize(0.05)
#hdiffradius1.GetYaxis().SetTitleSize(0.05)
#hdiffradius1.GetYaxis().SetTitleOffset(1.5)


#hMCdiffradius1.Sumw2()
hMCdiffradius1.Scale(0.001/binwidth)
hMCdiffradius1.SetFillColor(ROOT.kOrange-2)
m = hMCdiffradius1.GetEntries()
hMCdiffradius1.Scale(1./m)
hMCdiffradius1.Rebin(10)
leg.AddEntry(hMCdiffradius1,"200 MeV/c MC","p")
hdiffradius1.GetXaxis().SetRangeUser(0,250)
hMCdiffradius1.GetXaxis().SetRangeUser(0,250)
hdiffradius1.GetYaxis().SetRangeUser(0,20e-6)
hMCdiffradius1.GetYaxis().SetRangeUser(0,20e-6)
hMCdiffradius1.Draw()
hdiffradius1.Draw("e1 p same")

line3 = TLine()
line3.DrawLine(90,0,90,18e-6);
arrow2 = TArrow(90, 16e-6, 50, 16e-6,.05)
arrow2.Draw()
t1.Draw()
t2.Draw()

leg.Draw("same")
c.Print("LiHMCDatadiffradius200.pdf")
c.Print("LiHMCDatadiffradius200.jpg")

c.Clear()
leg.Clear()
c.SetLogy(0)
c.SetBottomMargin(0.125)
c.SetLeftMargin(0.15)
c.SetTopMargin(0.07)
c.SetRightMargin(0.05)
leg = TLegend(0.65,0.65,0.925,0.925)
leg.SetLineColor(10)
hprojradius1.SetMarkerStyle(20)

hprojradius1.Sumw2()
n = hprojradius1.GetEntries()
hprojradius1.Scale(1./n)
hprojradius1.SetStats(0)
hMCprojradius1.SetStats(0)
hprojradius1.Rebin(10)
print hprojradius1.GetXaxis().GetBinWidth(20)
leg.AddEntry(hprojradius1,"200 MeV/c Data","p")
hprojradius1.SetTitle(";radius (mm);No. of events")
hMCprojradius1.SetTitle(";radius (mm);No. of events")
binwidth = hprojradius1.GetXaxis().GetBinWidth(50)
print binwidth
#hprojradius1.Scale(0.001/binwidth)
#hprojradius1.GetYaxis().SetTitleOffset(1.05)
#hprojradius1.GetXaxis().SetRangeUser(0,250)
#hprojradius1.GetYaxis().SetRangeUser(5e-6,0.1)
#hMCprojradius1.GetYaxis().SetRangeUser(5e-6,0.1)
c.Update()
#hprojradius1.GetXaxis().SetLabelSize(0.05)
#hprojradius1.GetXaxis().SetTitleSize(0.05)
#hprojradius1.GetYaxis().SetLabelSize(0.05)
#hprojradius1.GetYaxis().SetTitleSize(0.05)
#hprojradius1.GetYaxis().SetTitleOffset(1.5)


#hMCprojradius1.GetXaxis().SetRangeUser(0,250)
#hMCprojradius1.Sumw2()
#hMCprojradius1.Scale(0.001/binwidth)
m = hMCprojradius1.GetEntries()
hMCprojradius1.Scale(1./m)
hMCprojradius1.Rebin(10)
leg.AddEntry(hMCprojradius1,"200 MeV/c MC","l")
hMCprojradius1.SetFillColor(ROOT.kOrange-2)
hprojradius1.GetYaxis().SetRangeUser(5e-6,0.04)
hMCprojradius1.GetYaxis().SetRangeUser(5e-6,0.04)
hMCprojradius1.Draw()
hprojradius1.Draw("e1 p same")
line2 = TLine()
line2.DrawLine(90,0,90,0.04);
arrow = TArrow(90, 0.014, 50, 0.014,.05)
arrow.Draw()

t1.Draw()
t2.Draw()

leg.Draw("same")
c.Print("LiHMCDataprojradius200.pdf")
c.Print("LiHMCDataprojradius200.jpg")

#'''
#c.Clear()
#leg.Clear()
#t3 = TText(0.18,0.885,"MICE isis cycle 2015/03")
#t3.SetNDC(1)
#t3.SetTextSize(0.04)
#t3.SetTextFont(42)
#t4 = TText(0.18,0.85,"Xenon, Pion Beam, MAUS v3.3.2")
#t4.SetNDC(1)
#t4.SetTextSize(0.03)
#t4.SetTextFont(42)
#h3.SetLineColor(4)
#h3.SetMarkerColor(4)
#h3.SetLineStyle(9)
#h3.SetMarkerStyle(20)
#h3.SetLineWidth(2)

#n = h3.GetEntries()
#h3.Scale(1./n)
#h3.SetStats(0)
#h3.Rebin(1)
#print h3.GetXaxis().GetBinWidth(20)
#leg.AddEntry(h3,"240 MeV/c","p")
#h3.SetTitle(";#theta_{X} (radians);Probability per mrad")
#binwidth = h3.GetXaxis().GetBinWidth(50)
#print binwidth
#h3.Scale(0.001/binwidth)
##h3.GetYaxis().SetTitleOffset(1.05)
#h3.GetXaxis().SetRangeUser(-0.06,0.06)
#h3.GetYaxis().SetRangeUser(5e-6,0.05)
##h3.GetXaxis().SetLabelSize(0.05)
##h3.GetXaxis().SetTitleSize(0.05)
##h3.GetYaxis().SetLabelSize(0.05)
##h3.GetYaxis().SetTitleSize(0.05)
##h3.GetYaxis().SetTitleOffset(1.5)
#h3.Draw("p")
#t3.Draw()
#t4.Draw()
#leg.Draw()
#c.Print("Xe_Raw.pdf")
#c.Print("Xe_Raw_pq.jpg")

#c.Clear()
#leg.Clear()

#t5 = TText(0.18,0.85,"Helium, Pion Beam, MAUS v3.3.2")
#t5.SetNDC(1)
#t5.SetTextSize(0.03)
#t5.SetTextFont(42)
#hz3.SetLineColor(4)
#hz3.SetMarkerColor(4)
#hz3.SetLineStyle(9)
#hz3.SetMarkerStyle(20)
#hz3.SetLineWidth(2)

#n = hz3.GetEntries()
#hz3.Scale(1./n)
#hz3.SetStats(0)
#hz3.Rebin(1)
#print hz3.GetXaxis().GetBinWidth(20)
#leg.AddEntry(hz3,"240 MeV/c","p")
#hz3.SetTitle(";#theta_{X} (radians);Probability per mrad")
#binwidth = hz3.GetXaxis().GetBinWidth(50)
#print binwidth
#hz3.Scale(0.001/binwidth)
##hz3.GetYaxis().SetTitleOffset(1.05)
#hz3.GetXaxis().SetRangeUser(-0.06,0.06)
#hz3.GetYaxis().SetRangeUser(5e-6,0.05)
##hz3.GetXaxis().SetLabelSize(0.05)
##hz3.GetXaxis().SetTitleSize(0.05)
##hz3.GetYaxis().SetLabelSize(0.05)
##hz3.GetYaxis().SetTitleSize(0.05)
##hz3.GetYaxis().SetTitleOffset(1.5)
#hz3.Draw("p")
#t3.Draw()
#t5.Draw()
#leg.Draw()
#c.Print("He_Raw.pdf")
#c.Print("He_Raw_pq.jpg")
#'''



c.SetLogy()
leg = TLegend(0.75,0.25,0.925,0.425)
ht0.SetLineColor(4)
ht0.SetLineStyle(9)
ht0.SetLineWidth(2)
ht0.SetStats(0)
nz = ht0.GetEntries()
ht0.Scale(1./nz)
ht0.Rebin(1)
ht0.GetXaxis().SetRangeUser(-0.06,0.06)
ht0.GetYaxis().SetRangeUser(5e-5,0.1)
print ht0.GetXaxis().GetBinWidth(20)
leg.AddEntry(ht0,"172 MeV/c","l")
ht0.SetTitle(";#theta_{X} (radians);Probability per mrad")
binwidth = ht0.GetXaxis().GetBinWidth(50)
print binwidth
ht0.Scale(0.001/binwidth)
#ht0.GetXaxis().SetLabelSize(0.05)
#ht0.GetXaxis().SetTitleSize(0.05)
#ht0.GetYaxis().SetLabelSize(0.05)
#ht0.GetYaxis().SetTitleSize(0.05)
#ht0.GetYaxis().SetTitleOffset(1.5)
ht0.Draw()

ht1.SetLineColor(2)
ht1.SetLineStyle(5)
ht1.SetLineWidth(2)
mz = ht1.GetEntries()
ht1.Scale(1./mz)
ht1.Scale(0.001/binwidth)
ht1.Rebin(1)
leg.AddEntry(ht1,"200 MeV/c","l")
ht1.Draw("same")

ht2.SetLineColor(1)
ht2.SetLineStyle(1)
ht2.SetLineWidth(2)
qz = ht2.GetEntries()
ht2.Scale(1./qz)
ht2.Scale(0.001/binwidth)
ht2.Rebin(1)
leg.AddEntry(ht2,"240 MeV/c","l")
ht2.Draw("same")

t7 = TText(0.18,0.885,"MICE GEANT4 Simulation")
t7.SetNDC(1)
t7.SetTextSize(0.04)
t7.SetTextFont(42)
t8 = TText(0.18,0.85,"LiH, Muon Beams, MAUS v3.3.2")
t8.SetNDC(1)
t8.SetTextSize(0.03)
t8.SetTextFont(42)
t7.Draw()
t8.Draw()
leg.Draw("same")
c.Print("GEANT4_LiH_Combined.pdf")
c.Print("GEANT4_LiH_Combined_pq.jpg")
leg.Clear()
'''
ht3.SetLineColor(1)
ht3.SetLineStyle(1)
ht3.SetLineWidth(2)
qz = ht3.GetEntries()
ht3.Scale(1./qz)
ht3.Scale(0.001/binwidth)
ht3.Rebin(1)
ht3.GetXaxis().SetRangeUser(-0.06,0.06)
ht3.GetYaxis().SetRangeUser(5e-5,0.1)
ht3.SetStats(0)
leg.AddEntry(ht3,"240 MeV/c","l")
ht3.Draw()
t7.Draw()
t4.Draw()
leg.Draw("same")
c.Print("GEANT4_Xe.pdf")
c.Print("GEANT4_Xe_pq.jpg")
leg.Clear()
'''
hrg0.SetLineColor(4)
hrg0.SetLineStyle(9)
hrg0.SetLineWidth(2)
hrg0.SetStats(0)
nz = hrg0.GetEntries()
hrg0.Scale(1./nz)
hrg0.Rebin(1)
hrg0.GetXaxis().SetRangeUser(-0.06,0.06)
#hrg0.GetYaxis().SetRangeUser(5e-6,0.1)
print hrg0.GetXaxis().GetBinWidth(20)
leg.AddEntry(hrg0,"172 MeV/c","l")
hrg0.SetTitle(";#theta_{Y} (radians);Probability per mrad")
binwidth = hrg0.GetXaxis().GetBinWidth(50)
print binwidth
hrg0.Scale(0.001/binwidth)
#hrg0.GetXaxis().SetLabelSize(0.05)
#hrg0.GetXaxis().SetTitleSize(0.05)
#hrg0.GetYaxis().SetLabelSize(0.05)
#hrg0.GetYaxis().SetTitleSize(0.05)
#hrg0.GetYaxis().SetTitleOffset(1.5)
hrg0.DrawNormalized()

hrg1.SetLineColor(2)
hrg1.SetLineStyle(5)
hrg1.SetLineWidth(2)
mz = hrg1.GetEntries()
hrg1.Scale(1./mz)
hrg1.Scale(0.001/binwidth)
hrg1.Rebin(1)
hrg1.GetXaxis().SetRangeUser(-0.06,0.06)
#hrg1.GetYaxis().SetRangeUser(5e-6,0.1)
leg.AddEntry(hrg1,"200 MeV/c","l")
hrg1.DrawNormalized("same")

hrg2.SetLineColor(1)
hrg2.SetLineStyle(1)
hrg2.SetLineWidth(2)
qz = hrg2.GetEntries()
hrg2.Scale(1./qz)
hrg2.Scale(0.001/binwidth)
hrg2.Rebin(1)
hrg2.GetXaxis().SetRangeUser(-0.06,0.06)
#hrg2.GetYaxis().SetRangeUser(5e-6,0.1)
leg.AddEntry(hrg2,"240 MeV/c","l")
hrg2.DrawNormalized("same")


t90 = TText(0.38,0.22,"MICE Internal")
t90.SetNDC(1)
t90.SetTextSize(0.04)
t90.SetTextFont(42)
t10 = TText(0.38,0.15,"LiH, Muon Beams, MAUS v3.3.2")
t10.SetNDC(1)
t10.SetTextSize(0.03)
t10.SetTextFont(42)
t91 = TText(0.38,0.185,"ISIS cycle 2015/04")
t91.SetNDC(1)
t91.SetTextSize(0.04)
t91.SetTextFont(42)
t90.Draw()
t91.Draw()
t10.Draw()
t90.Draw()
t10.Draw()
leg.Draw("same")
c.Print("Deco_GEANT_Combined.pdf")
c.Print("Deco_GEANT_Combined_pq.jpg")
leg.Clear()
'''
hc3.SetLineColor(1)
hc3.SetLineStyle(1)
hc3.SetLineWidth(2)
qz = hc3.GetEntries()
hc3.Scale(1./qz)
hc3.Scale(0.001/binwidth)
hc3.Rebin(1)
hc3.GetXaxis().SetRangeUser(-0.06,0.06)
hc3.GetYaxis().SetRangeUser(5e-5,0.1)
hc3.SetStats(0)
leg.AddEntry(hc3,"240 MeV/c","l")
hc3.Draw()
t9.Draw()
t4.Draw()
leg.Draw("same")
c.Print("Carlisle-Cobb_Xe.pdf")
c.Print("Carlisle-Cobb_Xe_pq.jpg")
leg.Clear()
'''
hc0.SetLineColor(4)
hc0.SetLineStyle(9)
hc0.SetLineWidth(2)
hc0.SetStats(0)
nz = hc0.GetEntries()
hc0.Scale(1./nz)
hc0.Rebin(1)
hc0.GetXaxis().SetRangeUser(-0.06,0.06)
hc0.GetYaxis().SetRangeUser(5e-6,0.1)
print hc0.GetXaxis().GetBinWidth(20)
leg.AddEntry(hc0,"172 MeV/c","l")
hc0.SetTitle(";#theta_{X} (radians);Probability per mrad")
binwidth = hc0.GetXaxis().GetBinWidth(50)
print binwidth
hc0.Scale(0.001/binwidth)
#hc0.GetXaxis().SetLabelSize(0.05)
#hc0.GetXaxis().SetTitleSize(0.05)
#hc0.GetYaxis().SetLabelSize(0.05)
#hc0.GetYaxis().SetTitleSize(0.05)
#hc0.GetYaxis().SetTitleOffset(1.5)
hc0.Draw()

hc1.SetLineColor(2)
hc1.SetLineStyle(5)
hc1.SetLineWidth(2)
mz = hc1.GetEntries()
hc1.Scale(1./mz)
hc1.Scale(0.001/binwidth)
hc1.Rebin(1)
hc1.GetXaxis().SetRangeUser(-0.06,0.06)
hc1.GetYaxis().SetRangeUser(5e-6,0.1)
leg.AddEntry(hc1,"200 MeV/c","l")
hc1.Draw("same")

hc2.SetLineColor(1)
hc2.SetLineStyle(1)
hc2.SetLineWidth(2)
qz = hc2.GetEntries()
hc2.Scale(1./qz)
hc2.Scale(0.001/binwidth)
hc2.Rebin(1)
hc2.GetXaxis().SetRangeUser(-0.06,0.06)
hc2.GetYaxis().SetRangeUser(5e-6,0.1)
leg.AddEntry(hc2,"240 MeV/c","l")
hc2.Draw("same")


t9 = TText(0.18,0.885,"MICE Carlisle-Cobb Simulation")
t9.SetNDC(1)
t9.SetTextSize(0.04)
t9.SetTextFont(42)
t10 = TText(0.18,0.85,"LiH, Muon Beams, MAUS v3.3.2")
t10.SetNDC(1)
t10.SetTextSize(0.03)
t10.SetTextFont(42)
t9.Draw()
t10.Draw()
t9.Draw()
t10.Draw()
leg.Draw("same")
c.Print("Cobb-Carlisle_Combined.pdf")
c.Print("Cobb-Carlisle_Combined_pq.jpg")
leg.Clear()

# Three models together

c.Clear()
c.SetLogy(0)

ht0.SetLineColor(4)
ht0.SetLineStyle(9)
ht0.SetLineWidth(2)
ht0.SetStats(0)
nz = ht0.GetEntries()
ht0.Scale(1./nz)
#ht0.Scale(1./ht0.GetBinContent(ht0.GetMaximumBin()))
ht0.Rebin(1)
ht0.GetXaxis().SetRangeUser(-0.06,0.06)
#ht0.GetYaxis().SetRangeUser(5e-5,0.01)
#ht0.GetYaxis().SetRangeUser(0,1.5)
print ht0.GetXaxis().GetBinWidth(20)
leg.AddEntry(ht0,"172 MeV/c GEANT 4.9.6.p02","l")
ht0.SetTitle(";#theta_{X} (radians);Probability per 3 mrad")
binwidth = ht0.GetXaxis().GetBinWidth(50)
print binwidth
# ht0.Scale(0.001/binwidth)
#ht0.GetXaxis().SetLabelSize(0.05)
#ht0.GetXaxis().SetTitleSize(0.05)
#ht0.GetYaxis().SetLabelSize(0.05)
#ht0.GetYaxis().SetTitleSize(0.05)
#ht0.GetYaxis().SetTitleOffset(1.5)
#ht0.DrawNormalized()
ht0.Draw()
print 'ht0.GetBinContent(23)',ht0.GetBinContent(23)

hm0.Rebin(4)
hm0.SetLineColor(3)
hm0.SetLineStyle(8)
hm0.SetLineWidth(2)
hm0.SetStats(0)
nz = hm0.GetEntries()
hm0.Scale(1./nz)
#hm0.Scale(1./hm0.GetBinContent(hm0.GetMaximumBin()))
# hm0.Scale(0.001/binwidth)
print hm0.GetXaxis().GetBinWidth(20)
leg.AddEntry(hm0,"172 MeV/c Moliere","l")
hm0.SetTitle(";#theta_{X} (radians);Probability per 3 mrad")
#hm0.DrawNormalized("same")
hm0.Draw("same")

hc0.Rebin(4)
hc0.SetLineColor(2)
hc0.SetLineStyle(7)
hc0.SetLineWidth(2)
hc0.SetStats(0)
nz = hc0.GetEntries()
hc0.Scale(1./nz)
#hc0.Scale(1./hc0.GetBinContent(hc0.GetMaximumBin()))
# hc0.Scale(0.001/binwidth)
print hc0.GetXaxis().GetBinWidth(20)
leg.AddEntry(hc0,"172 MeV/c Cobb","l")
hc0.SetTitle(";#theta_{X} (radians);Probability per 3 mrad")
#hc0.DrawNormalized("same")
hc0.GetYaxis().SetRangeUser(0,0.01)
# hc0.Draw("same")

t7 = TText(0.18,0.885,"MICE preliminary [simulation]")
t7.SetNDC(1)
t7.SetTextSize(0.04)
t7.SetTextFont(42)
t8 = TText(0.18,0.85,"LiH, MAUS v3.3.2")
t8.SetNDC(1)
t8.SetTextSize(0.03)
t8.SetTextFont(42)
t7.Draw()
t8.Draw()
leg.Draw("same")
c.Print("Models_LiH_Combined.pdf")
c.Print("Models_LiH_Combined_pq.jpg")
leg.Clear()

# Next

c.SetLogy()
hm0.SetLineColor(4)
hm0.SetLineStyle(9)
hm0.SetLineWidth(2)
hm0.SetStats(0)
nz2 = hm0.GetEntries()
hm0.Scale(1./nz)
hm0.Rebin(1)
hm0.GetXaxis().SetRangeUser(-0.06,0.06)
hm0.GetYaxis().SetRangeUser(5e-5,0.1)
print hm0.GetXaxis().GetBinWidth(20)
leg.AddEntry(hm0,"172 MeV/c","l")
hm0.SetTitle(";#theta_{X} (radians);Probability per mrad")
binwidth = hm0.GetXaxis().GetBinWidth(50)
print binwidth
hm0.Scale(0.001/binwidth)
#hm0.GetXaxis().SetLabelSize(0.05)
#hm0.GetXaxis().SetTitleSize(0.05)
#hm0.GetYaxis().SetLabelSize(0.05)
#hm0.GetYaxis().SetTitleSize(0.05)
#hm0.GetYaxis().SetTitleOffset(1.5)
hm0.Draw()

hm1.SetLineColor(2)
hm1.SetLineStyle(5)
hm1.SetLineWidth(2)
mz2 = hm1.GetEntries()
hm1.Scale(1./mz)
hm1.Scale(0.001/binwidth)
hm1.Rebin(1)
leg.AddEntry(hm1,"200 MeV/c","l")
hm1.Draw("same")

hm2.SetLineColor(1)
hm2.SetLineStyle(1)
hm2.SetLineWidth(2)
qz2 = hm2.GetEntries()
hm2.Scale(1./qz)
hm2.Scale(0.001/binwidth)
hm2.Rebin(1)
leg.AddEntry(hm2,"240 MeV/c","l")
hm2.Draw("same")

t70 = TText(0.18,0.885,"MICE Moliere Simulation")
t70.SetNDC(1)
t70.SetTextSize(0.04)
t70.SetTextFont(42)
t80 = TText(0.18,0.85,"LiH, Muon Beams, MAUS v3.3.2")
t80.SetNDC(1)
t80.SetTextSize(0.03)
t80.SetTextFont(42)
t70.Draw()
t80.Draw()
leg.Draw("same")
c.Print("Moliere_LiH_Combined.pdf")
c.Print("Moliere_LiH_Combined_pq.jpg")

c.Clear()
leg.Clear()
c.SetLogy(0)
t101 = TText(0.18,0.885,"MICE Internal ISIS cycle 2015/04")
t201 = TText(0.18,0.85,"LiH, MAUS v3.3.2")
t101.SetNDC(1)
t101.SetTextSize(0.04)
t101.SetTextFont(42)
t201.SetNDC(1)
t201.SetTextSize(0.03)
t201.SetTextFont(42)
leg.AddEntry(h21refx,"Data","p")
leg.AddEntry(m21refx,"MC","l")
h21refx.SetStats(0)
h21refx.SetTitle("")
h21refx.SetMarkerStyle(20)
m21refx.SetFillColor(ROOT.kOrange-2)
#m21refx.SetLineStyle(2)
m21refx.SetStats(0)
m21refx.SetTitle("")
#m21refx.GetXaxis().SetLabelSize(0.05)
#m21refx.GetXaxis().SetTitleSize(0.05)
#m21refx.GetYaxis().SetLabelSize(0.05)
m21refx.GetYaxis().SetTitle("No. of events")
#m21refx.GetYaxis().SetTitleSize(0.05)
#m21refx.Sumw2()
h21refx.Sumw2()
nref21 = h21refx.GetEntries()
h21refx.Scale(1./nref21)
lref21 = m21refx.GetEntries()
m21refx.Scale(1./lref21)
#h21refx.GetYaxis().SetRangeUser(0,0.08)
#m21refx.GetYaxis().SetRangeUser(0,0.08)
m21refx.Draw()
h21refx.Draw("e1 p same")
leg.Draw("same")
t101.Draw("same")
t201.Draw("same")
c.Print("MCDatarefX.pdf")

leg.Clear()
c.Clear()
c.SetLogy(0)
leg.Clear()
leg.AddEntry(h21refy,"Data","p")
leg.AddEntry(m21refy,"MC","l")
h21refy.SetStats(0)
h21refy.SetTitle("")
h21refy.SetMarkerStyle(20)
m21refy.SetFillColor(ROOT.kOrange-2)
m21refy.SetTitle("")
m21refy.SetStats(0)
m21refy.GetYaxis().SetRangeUser(0,0.1)
m21refy.GetYaxis().SetTitle("No. of events")
#m21refy.GetXaxis().SetLabelSize(0.05)
#m21refy.GetXaxis().SetTitleSize(0.05)
#m21refy.GetYaxis().SetLabelSize(0.05)
#m21refy.GetYaxis().SetTitleSize(0.05)
h21refy.Sumw2()
nref21 = h21refy.GetEntries()
h21refy.Scale(1./nref21)
lref21 = m21refy.GetEntries()
m21refy.Scale(1./lref21)
h21refy.GetYaxis().SetRangeUser(0,0.08)
m21refy.GetYaxis().SetRangeUser(0,0.08)
m21refy.Draw()
h21refy.Draw("e1 p same")
leg.Draw("same")
t101.Draw("same")
t201.Draw("same")
c.Print("MCDatarefY.pdf")

c.Clear()
leg.Clear()
c.SetLogy(0)
t101 = TText(0.18,0.885,"MICE Internal ISIS cycle 2015/04")
t201 = TText(0.18,0.85,"LiH, MAUS v3.3.2")
t101.SetNDC(1)
t101.SetTextSize(0.04)
t101.SetTextFont(42)
t201.SetNDC(1)
t201.SetTextSize(0.03)
t201.SetTextFont(42)
leg.AddEntry(h21x,"Data","p")
leg.AddEntry(m21x,"MC","f")
h21x.SetStats(0)
h21x.SetTitle("")
h21x.SetMarkerStyle(20)
m21x.SetFillColor(ROOT.kOrange-2)
#m21x.SetLineStyle(2)
m21x.SetStats(0)
m21x.SetTitle("")
#m21x.GetXaxis().SetLabelSize(0.05)
#m21x.GetXaxis().SetTitleSize(0.05)
#m21x.GetYaxis().SetLabelSize(0.05)
m21x.GetYaxis().SetTitle("")
#m21x.GetYaxis().SetTitleSize(0.05)
#m21x.Sumw2()
h21x.Sumw2()
n21 = h21x.GetEntries()
h21x.Scale(1./n21)
l21 = m21x.GetEntries()
m21x.Scale(1./l21)
h21x.GetYaxis().SetRangeUser(0,0.08)
m21x.GetYaxis().SetRangeUser(0,0.08)
m21x.Draw()
h21x.Draw("e1 p same")
leg.Draw("same")
t1.Draw("same")
t2.Draw("same")
t3.Draw("same")
c.Print("MCDataX.pdf")

leg.Clear()
c.Clear()
c.SetLogy(0)
leg.Clear()
leg.AddEntry(h21y,"Data","p")
leg.AddEntry(m21y,"MC","f")
h21y.SetStats(0)
h21y.SetTitle("")
h21y.SetMarkerStyle(20)
m21y.SetFillColor(ROOT.kOrange-2)
m21y.SetTitle("")
m21y.SetStats(0)
m21y.GetYaxis().SetRangeUser(0,0.1)
m21y.GetYaxis().SetTitle("")
#m21y.GetXaxis().SetLabelSize(0.05)
#m21y.GetXaxis().SetTitleSize(0.05)
#m21y.GetYaxis().SetLabelSize(0.05)
#m21y.GetYaxis().SetTitleSize(0.05)
h21y.Sumw2()
n21 = h21y.GetEntries()
h21y.Scale(1./n21)
l21 = m21y.GetEntries()
m21y.Scale(1./l21)
h21y.GetYaxis().SetRangeUser(0,0.08)
m21y.GetYaxis().SetRangeUser(0,0.08)
m21y.Draw()
h21y.Draw("e1 p same")
leg.Draw("same")
t1.Draw("same")
t2.Draw("same")
t3.Draw("same")
c.Print("MCDataY.pdf")

leg.Clear()
c.Clear()
c.SetLogy(0)
leg.Clear()
leg.AddEntry(h24x,"Data","p")
leg.AddEntry(m24x,"MC","l")
h24x.SetStats(0)
h24x.SetTitle("")
h24x.SetMarkerStyle(20)
m24x.SetFillColor(ROOT.kOrange-2)
m24x.SetStats(0)
m24x.SetTitle("")
#m24x.GetXaxis().SetLabelSize(0.05)
#m24x.GetXaxis().SetTitleSize(0.05)
m24x.GetYaxis().SetTitle("No. of events")
#m24x.GetYaxis().SetLabelSize(0.05)
#m24x.GetYaxis().SetTitleSize(0.05)
h24x.Sumw2()
n24 = h24x.GetEntries()
h24x.Scale(1./n24)
l24 = m24x.GetEntries()
m24x.Scale(1./l24)
h24x.GetYaxis().SetRangeUser(0,0.18)
m24x.GetYaxis().SetRangeUser(0,0.18)
m24x.Draw()
h24x.Draw("e1 p same")
leg.Draw("same")
t1.Draw("same")
t2.Draw("same")
t3.Draw("same")
c.Print("MCDatadXdz.pdf")

leg.Clear()
c.Clear()
c.SetLogy(0)
leg.Clear()
leg.AddEntry(h24y,"Data","p")
leg.AddEntry(m24y,"MC","l")
h24y.SetStats(0)
h24y.SetTitle("")
h24y.SetMarkerStyle(20)
m24y.SetFillColor(ROOT.kOrange-2)
m24y.SetStats(0)
#m24y.GetXaxis().SetLabelSize(0.05)
#m24y.GetXaxis().SetTitleSize(0.05)
#m24y.GetYaxis().SetLabelSize(0.05)
m24y.GetYaxis().SetTitle("No. of events")
#m24y.GetYaxis().SetTitleSize(0.05)
h24y.Sumw2()
n24 = h24y.GetEntries()
h24y.Scale(1./n24)
l24 = m24y.GetEntries()
m24y.Scale(1./l24)
h24y.GetYaxis().SetRangeUser(0,0.15)
m24y.GetYaxis().SetRangeUser(0,0.15)
m24y.Draw()
h24y.Draw("e1 p same")
leg.Draw("same")
t1.Draw("same")
t2.Draw("same")
t3.Draw("same")
c.Print("MCDatadYdz.pdf")

leg.Clear()
c.Clear()
c.SetLogy(0)
leg.Clear()
leg.AddEntry(h24xmisalign,"Data","p")
leg.AddEntry(m24x,"MC","f")
h24xmisalign.SetStats(0)
h24xmisalign.SetTitle("")
h24xmisalign.GetXaxis().SetTitle("")
h24xmisalign.SetMarkerStyle(20)
m24x.SetFillColor(ROOT.kOrange-2)
m24x.SetStats(0)
m24x.SetTitle("")
#m24x.GetXaxis().SetLabelSize(0.05)
#m24x.GetXaxis().SetTitleSize(0.05)
m24x.GetXaxis().SetTitle("#it{dx/dz}")
m24x.GetYaxis().SetTitle("")
#m24x.GetYaxis().SetLabelSize(0.05)
#m24x.GetYaxis().SetTitleSize(0.05)
h24xmisalign.Sumw2()
n24 = h24xmisalign.GetEntries()
h24xmisalign.Scale(1./n24)
l24 = m24x.GetEntries()
# m24x.Scale(1./l24)
h24xmisalign.GetYaxis().SetRangeUser(0,0.18)
m24x.GetYaxis().SetRangeUser(0,0.18)
h24xmisalign.GetXaxis().SetRangeUser(-0.075,0.075)
m24x.GetXaxis().SetRangeUser(-0.075,0.075)
m24x.Draw()
h24xmisalign.Draw("e1 p same")
leg.Draw("same")
t1.Draw("same")
t2.Draw("same")
t3.Draw("same")
c.Print("MCDatadXdzmisalign.pdf")

leg.Clear()
c.Clear()
c.SetLogy(0)
leg.Clear()
leg.AddEntry(h24ymisalign,"Data","p")
leg.AddEntry(m24y,"MC","f")
h24ymisalign.SetStats(0)
h24ymisalign.SetTitle("")
m24y.SetTitle("")
h24ymisalign.SetMarkerStyle(20)
m24y.SetFillColor(ROOT.kOrange-2)
m24y.SetStats(0)
#m24y.GetXaxis().SetLabelSize(0.05)
#m24y.GetXaxis().SetTitleSize(0.05)
m24y.GetXaxis().SetTitle("#it{dy/dz}")
#m24y.GetYaxis().SetLabelSize(0.05)
m24y.GetYaxis().SetTitle("")
h24ymisalign.GetYaxis().SetTitle("")
#m24y.GetYaxis().SetTitleSize(0.05)
h24ymisalign.Sumw2()
n24 = h24ymisalign.GetEntries()
h24ymisalign.Scale(1./n24)
l24 = m24y.GetEntries()
# m24y.Scale(1./l24)
h24ymisalign.GetYaxis().SetRangeUser(0,0.15)
m24y.GetYaxis().SetRangeUser(0,0.15)
h24ymisalign.GetXaxis().SetRangeUser(-0.075,0.075)
m24y.GetXaxis().SetRangeUser(-0.075,0.075)
m24y.Draw()
h24ymisalign.Draw("e1 p same")
leg.Draw("same")
t1.Draw("same")
t2.Draw("same")
t3.Draw("same")
c.Print("MCDatadYdzmisalign.pdf")

leg.Clear()
c.Clear()
c.SetLogy(0)
leg.Clear()
leg.AddEntry(hDS24y,"Data","p")
leg.AddEntry(mDS24y,"MC","l")
hDS24y.SetStats(0)
hDS24y.SetTitle("")
hDS24y.SetMarkerStyle(20)
mDS24y.SetFillColor(ROOT.kOrange-2)
mDS24y.SetStats(0)
#mDS24y.GetXaxis().SetLabelSize(0.05)
#mDS24y.GetXaxis().SetTitleSize(0.05)
#mDS24y.GetYaxis().SetLabelSize(0.05)
mDS24y.GetYaxis().SetTitle("No. of events")
#mDS24y.GetYaxis().SetTitleSize(0.05)
hDS24y.Sumw2()
n24 = hDS24y.GetEntries()
hDS24y.Scale(1./n24)
l24 = mDS24y.GetEntries()
mDS24y.Scale(1./l24)
hDS24y.GetYaxis().SetRangeUser(0,0.15)
mDS24y.GetYaxis().SetRangeUser(0,0.15)
mDS24y.Draw()
hDS24y.Draw("e1 p same")
leg.Draw("same")
t101.Draw("same")
t201.Draw("same")
c.Print("MCDataDSdYdz.pdf")

c.Clear()
leg.Clear()
leg.AddEntry(h21_pz,"LiH","p")
leg.AddEntry(href200_pz,"empty","l")
# h21_pz.SetStats(0)
h21_pz.SetTitle("")
h21_pz.SetMarkerStyle(20)
href200_pz.SetFillColor(ROOT.kRed-2)
# href200_pz.SetStats(1)
# TROOT.gStyle.SetOptFit(1)
# c.Update()
# stats=href200_pz.FindObject("stats")
# stats=href200_pz.GetListOfFunctions().FindObject("stats")
# stats=href200_pz.GetListOfFunctions()
# stats.Print()
# for l in stats:
#     print l
# stats.SetX1NDC(0.1);
#href200_pz.GetXaxis().SetLabelSize(0.05)
#href200_pz.GetXaxis().SetTitleSize(0.05)
#href200_pz.GetYaxis().SetLabelSize(0.05)
#href200_pz.GetYaxis().SetTitleSize(0.05)
h21_pz.Sumw2()
n21 = h21_pz.GetEntries()
h21_pz.Scale(1./n21)
l21 = href200_pz.GetEntries()
href200_pz.Scale(1./n21)
h21_pz.GetXaxis().SetRangeUser(150,300)
href200_pz.GetXaxis().SetRangeUser(150,300)
h21_pz.GetYaxis().SetRangeUser(0,0.1)
href200_pz.GetYaxis().SetRangeUser(0,0.1)
href200_pz.Draw()
h21_pz.Draw("sames")
t1.Draw()
t2.Draw()
c.Update()
stats=href200_pz.FindObject("stats")
stats.SetY1NDC(0.6);
stats.SetY2NDC(0.75);
leg.Draw("same")
c.Print("refDatacompz.pdf")
c.Clear()
leg.Clear()
leg.AddEntry(h22_pz,"LiH","p")
leg.AddEntry(href172_pz,"empty","l")
# h22_pz.SetStats(0)
h22_pz.SetTitle("")
h22_pz.SetMarkerStyle(20)
href172_pz.SetFillColor(ROOT.kRed-2)
# href172_pz.SetStats(0)
#href172_pz.GetXaxis().SetLabelSize(0.05)
#href172_pz.GetXaxis().SetTitleSize(0.05)
#href172_pz.GetYaxis().SetLabelSize(0.05)
#href172_pz.GetYaxis().SetTitleSize(0.05)
h22_pz.Sumw2()
n21 = h22_pz.GetEntries()
h22_pz.Scale(1./n21)
l21 = href172_pz.GetEntries()
href172_pz.Scale(1./n21)
h22_pz.GetXaxis().SetRangeUser(150,300)
href172_pz.GetXaxis().SetRangeUser(150,300)
h22_pz.GetYaxis().SetRangeUser(0,0.1)
href172_pz.GetYaxis().SetRangeUser(0,0.1)
href172_pz.Draw()
h22_pz.Draw("sames")
t1.Draw()
t2.Draw()
c.Update()
stats=href172_pz.FindObject("stats")
stats.SetY1NDC(0.6);
stats.SetY2NDC(0.75);
leg.Draw("same")
c.Print("refDatacompz172.pdf")
c.Clear()
leg.Clear()
leg.AddEntry(h23_pz,"LiH","p")
leg.AddEntry(href240_pz,"empty","l")
# h23_pz.SetStats(0)
h23_pz.SetTitle("")
h23_pz.SetMarkerStyle(20)
href240_pz.SetFillColor(ROOT.kRed-2)
# href240_pz.SetStats(0)
#href240_pz.GetXaxis().SetLabelSize(0.05)
#href240_pz.GetXaxis().SetTitleSize(0.05)
#href240_pz.GetYaxis().SetLabelSize(0.05)
#href240_pz.GetYaxis().SetTitleSize(0.05)
h23_pz.Sumw2()
n21 = h23_pz.GetEntries()
h23_pz.Scale(1./n21)
l21 = href240_pz.GetEntries()
href240_pz.Scale(1./n21)
h23_pz.GetXaxis().SetRangeUser(150,300)
href240_pz.GetXaxis().SetRangeUser(150,300)
h23_pz.GetYaxis().SetRangeUser(0,0.1)
href240_pz.GetYaxis().SetRangeUser(0,0.1)
href240_pz.Draw()
h23_pz.Draw("sames")
t1.Draw()
t2.Draw()
c.Update()
stats=href240_pz.FindObject("stats")
stats.SetY1NDC(0.6);
stats.SetY2NDC(0.75);
leg.Draw("same")
c.Print("refDatacompz240.pdf")
c.Clear()
leg.Clear()

leg.AddEntry(h21_pz,"Data","p")
leg.AddEntry(m21_pz,"MC","f")
h21_pz.SetStats(0)
h21_pz.SetTitle("")
h21_pz.SetMarkerStyle(20)
h21_pz.SetMarkerColor(ROOT.kBlack)
h21_pz.SetLineColor(ROOT.kBlack)
m21_pz.SetFillColor(ROOT.kOrange-2)
m21_pz.SetLineColor(ROOT.kBlack)
m21_pz.SetStats(0)
#m21_pz.GetXaxis().SetLabelSize(0.05)
#m21_pz.GetXaxis().SetTitleSize(0.05)
#m21_pz.GetYaxis().SetLabelSize(0.05)
#m21_pz.GetYaxis().SetTitleSize(0.05)
h21_pz.Sumw2()
n21 = h21_pz.GetEntries()
# h21_pz.Scale(1./n21)
l21 = m21_pz.GetEntries()
m21_pz.Scale(1./l21)
h21_pz.GetXaxis().SetRangeUser(150,300)
m21_pz.GetXaxis().SetRangeUser(150,300)
h21_pz.GetYaxis().SetRangeUser(0,0.07)
m21_pz.GetYaxis().SetRangeUser(0,0.07)
m21_pz.Draw()
h21_pz.Draw("same")
leg.Draw("same")
t1.Draw()
t3.Draw()
t2.Draw()
c.Print("MCDatacompz.pdf")
c.Clear()
leg.Clear()
leg.AddEntry(h22_pz,"Data","p")
leg.AddEntry(m22_pz,"MC","f")
h22_pz.SetStats(0)
h22_pz.SetTitle("")
h22_pz.SetMarkerStyle(20)
h22_pz.SetMarkerColor(ROOT.kBlack)
h22_pz.SetLineColor(ROOT.kBlack)
m22_pz.SetFillColor(ROOT.kOrange-2)
m22_pz.SetLineColor(ROOT.kBlack)
m22_pz.SetStats(0)
#m22_pz.GetXaxis().SetLabelSize(0.05)
#m22_pz.GetXaxis().SetTitleSize(0.05)
#m22_pz.GetYaxis().SetLabelSize(0.05)
#m22_pz.GetYaxis().SetTitleSize(0.05)
h22_pz.Sumw2()
n21 = h22_pz.GetEntries()
# h22_pz.Scale(1./n21)
l21 = m22_pz.GetEntries()
m22_pz.Scale(1./l21)
h22_pz.GetXaxis().SetRangeUser(150,300)
m22_pz.GetXaxis().SetRangeUser(150,300)
h22_pz.GetYaxis().SetRangeUser(0,0.07)
m22_pz.GetYaxis().SetRangeUser(0,0.07)
m22_pz.Draw()
h22_pz.Draw("same")
leg.Draw("same")
t1.Draw()
t3.Draw()
t2.Draw()
c.Print("MCDatacompz172.pdf")
c.Clear()
leg.Clear()
leg.AddEntry(h23_pz,"Data","p")
leg.AddEntry(m23_pz,"MC","f")
h23_pz.SetStats(0)
h23_pz.SetTitle("")
h23_pz.SetMarkerStyle(20)
h23_pz.SetMarkerColor(ROOT.kBlack)
h23_pz.SetLineColor(ROOT.kBlack)
m23_pz.SetFillColor(ROOT.kOrange-2)
m23_pz.SetLineColor(ROOT.kBlack)
m23_pz.SetStats(0)
#m23_pz.GetXaxis().SetLabelSize(0.05)
#m23_pz.GetXaxis().SetTitleSize(0.05)
#m23_pz.GetYaxis().SetLabelSize(0.05)
#m23_pz.GetYaxis().SetTitleSize(0.05)
h23_pz.Sumw2()
n21 = h23_pz.GetEntries()
# h23_pz.Scale(1./n21)
l21 = m23_pz.GetEntries()
m23_pz.Scale(1./l21)
h23_pz.GetXaxis().SetRangeUser(150,300)
m23_pz.GetXaxis().SetRangeUser(150,300)
h23_pz.GetYaxis().SetRangeUser(0,0.07)
m23_pz.GetYaxis().SetRangeUser(0,0.07)
m23_pz.Draw()
h23_pz.Draw("same")
leg.Draw("same")
t1.Draw()
t3.Draw()
t2.Draw()
c.Print("MCDatacompz240.pdf")
'''
c.Clear()
leg.Clear()
leg.AddEntry(h22_px,"Data","l")
leg.AddEntry(m22_px,"MC","l")
h22_px.SetLineColor(1)
m22_px.SetLineColor(2)
m22_px.SetLineStyle(2)
#m22_px.GetXaxis().SetLabelSize(0.05)
#m22_px.GetXaxis().SetTitleSize(0.05)
#m22_px.GetYaxis().SetLabelSize(0.05)
#m22_px.GetYaxis().SetTitleSize(0.05)
n22 = h22_px.GetEntries()
h22_px.Scale(1./n22)
l22 = m22_px.GetEntries()
m22_px.Scale(1./l22)
m22_px.Draw()
h22_px.Draw("same")
leg.Draw("same")
# c.Print("Momentum_Dist_240MeV.pdf")
'''

c.Clear()
leg.Clear()
tof01_0 = f0.Get("tof10")
# tof01_0.SetLabel(2,"US Track Found")
tof01_1 = f1.Get("tof10")
tof01_2 = f2.Get("tof10")
tof01_0.SetFillColor(2)
tof01_1.SetFillColor(4)
tof01_2.SetFillColor(8)
tof01_0.SetLineColor(2)
tof01_1.SetLineColor(4)
tof01_2.SetLineColor(8)
tof01_0.SetFillStyle(3003)
tof01_1.SetFillStyle(3004)
tof01_2.SetFillStyle(3005)
leg.AddEntry(tof01_0,"172 MeV/c","f")
leg.AddEntry(tof01_1,"200 MeV/c","f")
leg.AddEntry(tof01_2,"240 MeV/c","f")
# tof01_0.SetTitle("LiH Abs., Muon Beams, March 2016, MAUS v3.3.2")
tof01_0.GetXaxis().SetRangeUser(24.9537703996,33.1537703996)
tof01_0.GetYaxis().SetRangeUser(0,1.45e5)
tof01_0.GetYaxis().SetTitle("Events per 0.2 ns")
#tof01_0.GetXaxis().SetLabelSize(0.05)
#tof01_0.GetXaxis().SetTitleSize(0.05)
#tof01_0.GetYaxis().SetLabelSize(0.05)
#tof01_0.GetYaxis().SetTitleSize(0.05)
tof01_0.SetStats(0)
tof01_0.Draw()
tof01_1.Draw("same")
tof01_2.Draw("same")
leg.Draw()
t1.Draw()
t2.Draw()
c.Print("TOF10_dist.pdf")
c.Print("TOF10_dist_pq.jpg")

c.Clear()
leg.Clear()
P_0 = f1.Get("LiH_mom")
P_1 = fMC1.Get("LiH_mom")
P_0.SetMarkerStyle(20)
P_1.SetFillColor(ROOT.kOrange-2)
leg = TLegend(0.70,0.15,0.925,0.45)
leg.AddEntry(P_0,"200 MeV/c Data","p")
leg.AddEntry(P_1,"200 MeV/c MC","l")
P_0.GetYaxis().SetTitle("Events per 0.2 ns")
P_0.GetYaxis().SetTitle("Events per 0.2 ns")
#P_0.GetXaxis().SetLabelSize(0.05)
#P_0.GetXaxis().SetTitleSize(0.05)
#P_0.GetYaxis().SetLabelSize(0.05)
#P_0.GetYaxis().SetTitleSize(0.05)
P_0.SetStats(0)
P_0.Sumw2()
nP_0 = P_0.GetSumOfWeights()
print nP_0
#ntof21_0 = P_0.GetMaximum()
P_0.Scale(1./nP_0)
lP_1 = P_1.GetEntries()
#ltof21_1 = P_1.GetMaximum()
P_1.Scale(1./lP_1)
#P_0.GetXaxis().SetRangeUser(24.3365596446,33.3365596446)
#P_0.GetYaxis().SetRangeUser(0,0.16)
#P_1.GetXaxis().SetRangeUser(24.3365596446,33.3365596446)
#P_1.GetYaxis().SetRangeUser(0,0.16)
P_0.GetXaxis().SetRangeUser(100,300)
P_0.GetYaxis().SetRangeUser(0,0.2)
P_1.GetXaxis().SetRangeUser(100,300)
P_1.GetYaxis().SetRangeUser(0,0.2)
#P_1.DrawNormalized()
#P_0.DrawNormalized("e1 p same")
P_1.Draw()
P_0.Draw("e1 p same")
c.Update()
leg.Draw()
t1.Draw()
t2.Draw()
line4 = TLine()
line4.DrawLine(198,0,198,0.18);
line4.DrawLine(202,0,202,0.18);
c.Print("P_MCData.pdf")
c.Print("P_MCData_pq.jpg")

c.Clear()
leg.Clear()
tof21_0 = f1.Get("tof10")
tof21_1 = fMC1.Get("tof10")
tof21_0.SetMarkerStyle(20)
tof21_1.SetFillColor(ROOT.kOrange-2)
leg = TLegend(0.70,0.15,0.925,0.45)
leg.AddEntry(tof21_0,"200 MeV/c Data","p")
leg.AddEntry(tof21_1,"200 MeV/c MC","l")
tof21_0.GetYaxis().SetTitle("Events per 0.2 ns")
tof21_0.GetYaxis().SetTitle("Events per 0.2 ns")
#tof21_0.GetXaxis().SetLabelSize(0.05)
#tof21_0.GetXaxis().SetTitleSize(0.05)
#tof21_0.GetYaxis().SetLabelSize(0.05)
#tof21_0.GetYaxis().SetTitleSize(0.05)
tof21_0.SetStats(0)
tof21_0.Sumw2()
ntof21_0 = tof21_0.GetSumOfWeights()
print ntof21_0
#ntof21_0 = tof21_0.GetMaximum()
tof21_0.Scale(1./ntof21_0)
ltof21_1 = tof21_1.GetEntries()
#ltof21_1 = tof21_1.GetMaximum()
tof21_1.Scale(1./ltof21_1)
#tof21_0.GetXaxis().SetRangeUser(24.3365596446,33.3365596446)
#tof21_0.GetYaxis().SetRangeUser(0,0.16)
#tof21_1.GetXaxis().SetRangeUser(24.3365596446,33.3365596446)
#tof21_1.GetYaxis().SetRangeUser(0,0.16)
tof21_0.GetXaxis().SetRangeUser(24.9537703996,34.9537703996)
tof21_0.GetYaxis().SetRangeUser(0,0.2)
tof21_1.GetXaxis().SetRangeUser(24.9537703996,34.9537703996)
tof21_1.GetYaxis().SetRangeUser(0,0.2)
#tof21_1.DrawNormalized()
#tof21_0.DrawNormalized("e1 p same")
tof21_1.Draw()
tof21_0.Draw("e1 p same")
c.Update()
leg.Draw()
t1.Draw()
t2.Draw()
line4 = TLine()
line4.DrawLine(27.8559501868,0,27.8559501868,0.18);
line4.DrawLine(28.0559501868,0,28.0559501868,0.18);
c.Print("TOF10_MCData.pdf")
c.Print("TOF10_MCData_pq.jpg")

c.Clear()
leg.Clear()
# c.SetLogy()
chi2pern = f1.Get("chi2n")
chi2pern_1 = fMC1.Get("chi2n")
chi2pern.SetMarkerStyle(20)
chi2pern_1.SetFillColor(ROOT.kOrange-2)
leg = TLegend(0.70,0.15,0.925,0.45)
leg.AddEntry(chi2pern,"200 MeV/c Data","p")
leg.AddEntry(chi2pern_1,"200 MeV/c MC","l")
chi2pern.GetYaxis().SetTitle("No. of Events")
chi2pern_1.GetYaxis().SetTitle("No. of Events")
#chi2pern.GetXaxis().SetLabelSize(0.05)
#chi2pern.GetXaxis().SetTitleSize(0.05)
chi2pern.GetXaxis().SetTitle("#chi^2/ndf")
chi2pern_1.GetXaxis().SetTitle("#chi^2/ndf")
#chi2pern.GetYaxis().SetLabelSize(0.05)
#chi2pern.GetYaxis().SetTitleSize(0.05)
chi2pern.SetStats(0)
chi2pern.Sumw2()
nchi2pern = chi2pern.GetEntries()
chi2pern.Scale(1./nchi2pern)
lchi2pern_1 = chi2pern_1.GetEntries()
chi2pern_1.Scale(1./lchi2pern_1)
chi2pern.GetXaxis().SetRangeUser(0,50)
chi2pern.GetYaxis().SetRangeUser(1e-5,1.7)
chi2pern_1.GetXaxis().SetRangeUser(0,50)
chi2pern_1.GetYaxis().SetRangeUser(1e-5,1.7)
chi2pern_1.Draw()
chi2pern.Draw("e1 p same")
c.SetLogy()
leg.Draw()
t1.Draw()
t2.Draw()
line4 = TLine()
line4.DrawLine(4,0,4,0.5);
arrow2 = TArrow(4, 0.4, 3, .4)
arrow2.Draw()
c.Print("chi2n_MCData.pdf")
c.Print("chi2n_MCData_pq.jpg")
leg.Clear()

c.SetLogy()
c.SetBottomMargin(0.15)
accept_0 = f0.Get("cuts_accept")
accept_1 = f1.Get("cuts_accept")
accept_2 = f2.Get("cuts_accept")
accept_0.SetFillColor(2)
accept_1.SetFillColor(4)
accept_2.SetFillColor(8)
accept_0.SetLineColor(2)
accept_1.SetLineColor(4)
accept_2.SetLineColor(8)
accept_0.SetFillColor(2)
accept_1.SetFillColor(4)
accept_2.SetFillColor(8)
accept_0.SetBarWidth(0.25)
accept_1.SetBarWidth(0.25)
accept_2.SetBarWidth(0.25)
accept_0.SetBarOffset(0.0)
accept_1.SetBarOffset(0.3)
accept_2.SetBarOffset(0.6)
accept_0.SetMinimum(1e3)
accept_0.SetMaximum(8e6)
accept_0.GetXaxis().SetRange(1,4)
#accept_0.SetTitle("LiH Abs., Muon Beams, March 2016, MAUS v3.3.2")
leg.AddEntry(accept_0,"172 MeV/c","f")
leg.AddEntry(accept_1,"200 MeV/c","f")
leg.AddEntry(accept_2,"240 MeV/c","f")
#accept_0.GetXaxis().SetLabelSize(0.05)
#accept_0.GetXaxis().SetTitleSize(0.05)
#accept_0.GetYaxis().SetLabelSize(0.05)
#accept_0.GetYaxis().SetTitleSize(0.05)
#accept_0.GetXaxis().SetTitleOffset(1.25)
accept_0.SetStats(0)
accept_0.Draw("bar")
accept_1.Draw("barsame")
accept_2.Draw("barsame")
#leg.Draw()
t1.Draw()
t2.Draw()
c.Print("LiH_Accept_Cuts.pdf")
c.Print("LiH_Accept_Cuts_pq.jpg")
c.SetLogy(0)

c.Clear()

print accept_0.GetBinContent(2)/accept_0.GetBinContent(1),"&",accept_1.GetBinContent(2)/accept_1.GetBinContent(1),"&",accept_2.GetBinContent(2)/accept_2.GetBinContent(1),"\\"
print accept_0.GetBinContent(3)/accept_0.GetBinContent(1),"&",accept_1.GetBinContent(3)/accept_1.GetBinContent(1),"&",accept_2.GetBinContent(3)/accept_2.GetBinContent(1),"\\"
print accept_0.GetBinContent(4)/accept_0.GetBinContent(1),"&",accept_1.GetBinContent(4)/accept_1.GetBinContent(1),"&",accept_2.GetBinContent(4)/accept_2.GetBinContent(1),"\\"
print accept_0.GetBinContent(5)/accept_0.GetBinContent(1),"&",accept_1.GetBinContent(5)/accept_1.GetBinContent(1),"&",accept_2.GetBinContent(5)/accept_2.GetBinContent(1),"\\"

print h0.GetEntries()
# nsize=h0.GetIntegral().size()
total = 0
total1 = 0
total2 = 0
for i in range(1,48):
    total += h0.GetBinContent(i)
    total1 += h1.GetBinContent(i)*h1.GetEntries()
    print h1.GetBinContent(i)
    total2 += h2.GetBinContent(i)
print total
print total1
print h1.GetEntries()
print "start of pop table"
print h22_pz.GetMean(),"&",round(total/h0.GetEntries()*100,2),"\\\\"
print h212_pz.GetMean(),"&",round(total1/h1.GetEntries()*100,2),"\\\\"
print h23_pz.GetMean(),"&",round(total2/h2.GetEntries()*100,2),"\\\\"

# c.SetTopMargin(0.9)
# c.SetLogz()

c.SetRightMargin(0.15)
# c.SetBottomMargin(0.10)
XY_10 = f1.Get("dataUS_alltof_XY")
# XY_10.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.3.2")
XY_10.SetStats(0)
XY_10.SetTitle("")
# XY_10.SetMaximum(600)
XY_10.SetMinimum(50)
#XY_10.GetXaxis().SetLabelSize(0.05)
#XY_10.GetXaxis().SetTitleSize(0.05)
#XY_10.GetYaxis().SetLabelSize(0.05)
#XY_10.GetYaxis().SetTitleSize(0.05)
XY_10.Draw("colz")
# t1.Draw()
t2.Draw()
c.Print("dataUS_200_alltof_XY.pdf")
c.Print("dataUS_200_alltof_XY_pq.jpg")

print "172 &",round(h20x.GetRMS(),2),"&",round(h23x.GetRMS()*1e3,2),"&",round(h20y.GetRMS(),2),"&",round(h23y.GetRMS()*1e3,2),"\\\ "
print "200 &",round(h21x.GetRMS(),2),"&",round(h24x.GetRMS()*1e3,2),"&",round(h21y.GetRMS(),2),"&",round(h24y.GetRMS()*1e3,2),"\\\ "
print "240 &",round(h22x.GetRMS(),2),"&",round(h25x.GetRMS()*1e3,2),"&",round(h22y.GetRMS(),2),"&",round(h25y.GetRMS()*1e3,2),"\\\ "
print "172 &",round(h20DSx.GetRMS(),2),"&",round(hDS23x.GetRMS()*1e3,2),"&",round(h20DSy.GetRMS(),2),"&",round(hDS23y.GetRMS()*1e3,2),"\\\ "
print "200 &",round(h21DSx.GetRMS(),2),"&",round(hDS24x.GetRMS()*1e3,2),"&",round(h21DSy.GetRMS(),2),"&",round(hDS24y.GetRMS()*1e3,2),"\\\ "
print "240 &",round(h22DSx.GetRMS(),2),"&",round(hDS25x.GetRMS()*1e3,2),"&",round(h22DSy.GetRMS(),2),"&",round(hDS25y.GetRMS()*1e3,2),"\\\ "

c.Clear()
XY_11 = f1.Get("dataUS_dif_XY")
# XY_11.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.3.2")
XY_11.SetStats(0)
XY_11.SetTitle("")
# XY_11.SetMaximum(600)
XY_11.SetMinimum(2)
#XY_11.GetXaxis().SetLabelSize(0.05)
#XY_11.GetXaxis().SetTitleSize(0.05)
#XY_11.GetYaxis().SetLabelSize(0.05)
#XY_11.GetYaxis().SetTitleSize(0.05)
XY_11.Draw("colz")
# t1.Draw()
t2.Draw()
c.Print("dataUS_200_prerad_XY.pdf")
c.Print("dataUS_200_prerad_XY_pq.jpg")

c.Clear()
XY_12 = f1.Get("dataUS_XY")
# XY_12.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.3.2")
XY_12.SetStats(0)
XY_12.SetTitle("")
# XY_12.SetMaximum(600)
XY_12.SetMinimum(0)
#XY_12.GetXaxis().SetLabelSize(0.05)
#XY_12.GetXaxis().SetTitleSize(0.05)
#XY_12.GetYaxis().SetLabelSize(0.05)
#XY_12.GetYaxis().SetTitleSize(0.05)
XY_12.Draw("colz")
# t1.Draw()
t2.Draw()
c.Print("dataUS_200_XY.pdf")
c.Print("dataUS_200_XY_pq.jpg")

c.Clear()
dXdzdYdz_10 = f1.Get("dataUS_alltof_dXdzdYdz")
# dXdzdYdz_10.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.3.2")
dXdzdYdz_10.SetStats(0)
dXdzdYdz_10.SetTitle("")
# dXdzdYdz_10.SetMaximum(800)
dXdzdYdz_10.SetMinimum(20)
#dXdzdYdz_10.GetXaxis().SetLabelSize(0.05)
#dXdzdYdz_10.GetXaxis().SetTitleSize(0.05)
#dXdzdYdz_10.GetYaxis().SetLabelSize(0.05)
#dXdzdYdz_10.GetYaxis().SetTitleSize(0.05)
dXdzdYdz_10.GetXaxis().SetNdivisions(508)
dXdzdYdz_10.GetYaxis().SetNdivisions(508)
dXdzdYdz_10.Draw("colz")
# t1.Draw()
t2.Draw()
c.Print("dataUS_200_alltof_dXdzdYdz.pdf")
c.Print("dataUS_200_alltof_dXdzdYdz_pq.jpg")

c.Clear()
dXdzdYdz_11 = f1.Get("dataUS_dif_dXdzdYdz")
# dXdzdYdz_11.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.3.2)"
dXdzdYdz_11.SetStats(0)
dXdzdYdz_11.SetTitle("")
# dXdzdYdz_11.SetMaximum(800)
dXdzdYdz_11.SetMinimum(3)
#dXdzdYdz_11.GetXaxis().SetLabelSize(0.05)
#dXdzdYdz_11.GetXaxis().SetTitleSize(0.05)
#dXdzdYdz_11.GetYaxis().SetLabelSize(0.05)
#dXdzdYdz_11.GetYaxis().SetTitleSize(0.05)
dXdzdYdz_11.GetXaxis().SetNdivisions(508)
dXdzdYdz_11.GetYaxis().SetNdivisions(508)
dXdzdYdz_11.Draw("colz")
# t1.Draw()
t2.Draw()
c.Print("dataUS_200_prerad_dXdzdYdz.pdf")
c.Print("dataUS_200_prerad_dXdzdYdz_pq.jpg")

c.Clear()
dXdzdYdz_12 = f1.Get("dataUS_dXdzdYdz")
# dXdzdYdz_12.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.3.2")
dXdzdYdz_12.SetStats(0)
dXdzdYdz_12.SetTitle("")
# dXdzdYdz_12.SetMaximum(800)
dXdzdYdz_12.SetMinimum(0)
#dXdzdYdz_12.GetXaxis().SetLabelSize(0.05)
#dXdzdYdz_12.GetXaxis().SetTitleSize(0.05)
#dXdzdYdz_12.GetYaxis().SetLabelSize(0.05)
#dXdzdYdz_12.GetYaxis().SetTitleSize(0.05)
dXdzdYdz_12.GetXaxis().SetNdivisions(508)
dXdzdYdz_12.GetYaxis().SetNdivisions(508)
dXdzdYdz_12.Draw("colz")
# t1.Draw()
t2.Draw()
c.Print("dataUS_200_dXdzdYdz.pdf")
c.Print("dataUS_200_dXdzdYdz_pq.jpg")
# ================================================================


c.SetRightMargin(0.15)
# c.SetBottomMargin(0.10)
XY_10 = f1.Get("dataDS_alltof_XY")
# XY_10.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.3.2")
XY_10.SetStats(0)
XY_10.SetTitle("")
# XY_10.SetMaximum(600)
XY_10.SetMinimum(50)
#XY_10.GetXaxis().SetLabelSize(0.05)
#XY_10.GetXaxis().SetTitleSize(0.05)
#XY_10.GetYaxis().SetLabelSize(0.05)
#XY_10.GetYaxis().SetTitleSize(0.05)
XY_10.Draw("colz")
t1.Draw()
t2.Draw()
c.Print("dataDS_200_alltof_XY.pdf")
c.Print("dataDS_200_alltof_XY_pq.jpg")

c.Clear()
XY_11 = f1.Get("dataDS_dif_XY")
# XY_11.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.3.2")
XY_11.SetStats(0)
XY_11.SetTitle("")
# XY_11.SetMaximum(600)
XY_11.SetMinimum(2)
#XY_11.GetXaxis().SetLabelSize(0.05)
#XY_11.GetXaxis().SetTitleSize(0.05)
#XY_11.GetYaxis().SetLabelSize(0.05)
#XY_11.GetYaxis().SetTitleSize(0.05)
XY_11.Draw("colz")
# t1.Draw()
t2.Draw()
c.Print("dataDS_200_prerad_XY.pdf")
c.Print("dataDS_200_prerad_XY_pq.jpg")

c.Clear()
XY_12 = f1.Get("dataDS_XY")
# XY_12.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.3.2")
XY_12.SetStats(0)
XY_12.SetTitle("")
# XY_12.SetMaximum(600)
XY_12.SetMinimum(0)
#XY_12.GetXaxis().SetLabelSize(0.05)
#XY_12.GetXaxis().SetTitleSize(0.05)
#XY_12.GetYaxis().SetLabelSize(0.05)
#XY_12.GetYaxis().SetTitleSize(0.05)
XY_12.Draw("colz")
# t1.Draw()
t2.Draw()
c.Print("dataDS_200_XY.pdf")
c.Print("dataDS_200_XY_pq.jpg")

c.Clear()
dXdzdYdz_10 = f1.Get("dataDS_alltof_dXdzdYdz")
# dXdzdYdz_10.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.3.2")
dXdzdYdz_10.SetStats(0)
dXdzdYdz_10.SetTitle("")
# dXdzdYdz_10.SetMaximum(800)
dXdzdYdz_10.SetMinimum(20)
#dXdzdYdz_10.GetXaxis().SetLabelSize(0.05)
#dXdzdYdz_10.GetXaxis().SetTitleSize(0.05)
#dXdzdYdz_10.GetYaxis().SetLabelSize(0.05)
#dXdzdYdz_10.GetYaxis().SetTitleSize(0.05)
dXdzdYdz_10.GetXaxis().SetNdivisions(508)
dXdzdYdz_10.GetYaxis().SetNdivisions(508)
dXdzdYdz_10.Draw("colz")
# t1.Draw()
t2.Draw()
c.Print("dataDS_200_alltof_dXdzdYdz.pdf")
c.Print("dataDS_200_alltof_dXdzdYdz_pq.jpg")

c.Clear()
dXdzdYdz_11 = f1.Get("dataDS_dif_dXdzdYdz")
# dXdzdYdz_11.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.3.2)"
dXdzdYdz_11.SetStats(0)
dXdzdYdz_11.SetTitle("")
# dXdzdYdz_11.SetMaximum(800)
dXdzdYdz_11.SetMinimum(3)
#dXdzdYdz_11.GetXaxis().SetLabelSize(0.05)
#dXdzdYdz_11.GetXaxis().SetTitleSize(0.05)
#dXdzdYdz_11.GetYaxis().SetLabelSize(0.05)
#dXdzdYdz_11.GetYaxis().SetTitleSize(0.05)
dXdzdYdz_11.GetXaxis().SetNdivisions(508)
dXdzdYdz_11.GetYaxis().SetNdivisions(508)
dXdzdYdz_11.Draw("colz")
# t1.Draw()
t2.Draw()
c.Print("dataDS_200_prerad_dXdzdYdz.pdf")
c.Print("dataDS_200_prerad_dXdzdYdz_pq.jpg")

c.Clear()
dXdzdYdz_12 = f1.Get("dataDS_dXdzdYdz")
# dXdzdYdz_12.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.3.2")
dXdzdYdz_12.SetStats(0)
dXdzdYdz_12.SetTitle("")
# dXdzdYdz_12.SetMaximum(800)
dXdzdYdz_12.SetMinimum(0)
#dXdzdYdz_12.GetXaxis().SetLabelSize(0.05)
#dXdzdYdz_12.GetXaxis().SetTitleSize(0.05)
#dXdzdYdz_12.GetYaxis().SetLabelSize(0.05)
#dXdzdYdz_12.GetYaxis().SetTitleSize(0.05)
dXdzdYdz_12.GetXaxis().SetNdivisions(508)
dXdzdYdz_12.GetYaxis().SetNdivisions(508)
dXdzdYdz_12.Draw("colz")
t1.Draw()
t2.Draw()
c.Print("dataDS_200_dXdzdYdz.pdf")
c.Print("dataDS_200_dXdzdYdz_pq.jpg")

# ====================================================



t2 = TText(0.18,0.85,"Zero Abs., February 2016, MAUS v3.3.2")
t2.SetNDC(1)
t2.SetTextSize(0.03)
t2.SetTextFont(42)

c.Clear()
XY_10 = f1.Get("dataUSref_alltof_XY")
# XY_10.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.3.2")
XY_10.SetStats(0)
XY_10.SetTitle("")
# XY_10.SetMaximum(400)
XY_10.SetMinimum(10)
#XY_10.GetXaxis().SetLabelSize(0.05)
#XY_10.GetXaxis().SetTitleSize(0.05)
#XY_10.GetYaxis().SetLabelSize(0.05)
#XY_10.GetYaxis().SetTitleSize(0.05)
XY_10.Draw("colz")
# t1.Draw()
t2.Draw()
c.Print("dataUSref_200_alltof_XY.pdf")
c.Print("dataUSref_200_alltof_XY_pq.jpg")

c.Clear()
XY_11 = f1.Get("dataUSref_prerad_XY")
#XY_11.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.3.2")
XY_11.SetStats(0)
XY_11.SetTitle("")
# XY_11.SetMaximum(400)
XY_11.SetMinimum(2)
#XY_11.GetXaxis().SetLabelSize(0.05)
#XY_11.GetXaxis().SetTitleSize(0.05)
#XY_11.GetYaxis().SetLabelSize(0.05)
#XY_11.GetYaxis().SetTitleSize(0.05)
XY_11.Draw("colz")
# t1.Draw()
t2.Draw()
c.Print("dataUSref_200_prerad_XY.pdf")
c.Print("dataUSref_200_prerad_XY_pq.jpg")

c.Clear()
XY_12 = f1.Get("dataUSref_XY")
# XY_12.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.3.2")
XY_12.SetStats(0)
XY_12.SetTitle("")
# XY_12.SetMaximum(400)
XY_12.SetMinimum(1)
#XY_12.GetXaxis().SetLabelSize(0.05)
#XY_12.GetXaxis().SetTitleSize(0.05)
#XY_12.GetYaxis().SetLabelSize(0.05)
#XY_12.GetYaxis().SetTitleSize(0.05)
XY_12.Draw("colz")
# t1.Draw()
t2.Draw()
c.Print("dataUSref_200_XY.pdf")
c.Print("dataUSref_200_XY_pq.jpg")

c.Clear()
dXdzdYdz_10 = f1.Get("dataUSref_alltof_dXdzdYdz")
# dXdzdYdz_10.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.3.2")
dXdzdYdz_10.SetStats(0)
dXdzdYdz_10.SetTitle("")
# dXdzdYdz_10.SetMaximum(300)
dXdzdYdz_10.SetMinimum(10)
#dXdzdYdz_10.GetXaxis().SetLabelSize(0.05)
#dXdzdYdz_10.GetXaxis().SetTitleSize(0.05)
#dXdzdYdz_10.GetYaxis().SetLabelSize(0.05)
#dXdzdYdz_10.GetYaxis().SetTitleSize(0.05)
dXdzdYdz_10.GetXaxis().SetNdivisions(508)
dXdzdYdz_10.GetYaxis().SetNdivisions(508)
dXdzdYdz_10.Draw("colz")
# t1.Draw()
t2.Draw()
c.Print("dataUSref_200_alltof_dXdzdYdz.pdf")
c.Print("dataUSref_200_alltof_dXdzdYdz_pq.jpg")

c.Clear()
dXdzdYdz_11 = f1.Get("dataUSref_prerad_dXdzdYdz")
# dXdzdYdz_11.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.3.2")
dXdzdYdz_11.SetStats(0)
dXdzdYdz_11.SetTitle("")
# dXdzdYdz_11.SetMaximum(300)
dXdzdYdz_11.SetMinimum(2)
#dXdzdYdz_11.GetXaxis().SetLabelSize(0.05)
#dXdzdYdz_11.GetXaxis().SetTitleSize(0.05)
#dXdzdYdz_11.GetYaxis().SetLabelSize(0.05)
#dXdzdYdz_11.GetYaxis().SetTitleSize(0.05)
dXdzdYdz_11.GetXaxis().SetNdivisions(508)
dXdzdYdz_11.GetYaxis().SetNdivisions(508)
dXdzdYdz_11.Draw("colz")
# t1.Draw()
t2.Draw()
c.Print("dataUSref_200_prerad_dXdzdYdz.pdf")
c.Print("dataUSref_200_prerad_dXdzdYdz_pq.jpg")

c.Clear()
dXdzdYdz_12 = f1.Get("dataUSref_dXdzdYdz")
# dXdzdYdz_12.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.3.2")
dXdzdYdz_12.SetStats(0)
dXdzdYdz_12.SetTitle("")
# dXdzdYdz_12.SetMaximum(300)
dXdzdYdz_12.SetMinimum(0)
#dXdzdYdz_12.GetXaxis().SetLabelSize(0.05)
#dXdzdYdz_12.GetXaxis().SetTitleSize(0.05)
#dXdzdYdz_12.GetYaxis().SetLabelSize(0.05)
#dXdzdYdz_12.GetYaxis().SetTitleSize(0.05)
dXdzdYdz_12.GetXaxis().SetNdivisions(508)
dXdzdYdz_12.GetYaxis().SetNdivisions(508)
dXdzdYdz_12.Draw("colz")
# t1.Draw()
t2.Draw()
c.Print("dataUSref_200_dXdzdYdz.pdf")
c.Print("dataUSref_200_dXdzdYdz_pq.jpg")

# =====================================================


c.Clear()
XY_10 = f1.Get("dataDSref_alltof_XY")
# XY_10.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.3.2")
XY_10.SetStats(0)
XY_10.SetTitle("")
# XY_10.SetMaximum(400)
XY_10.SetMinimum(10)
#XY_10.GetXaxis().SetLabelSize(0.05)
#XY_10.GetXaxis().SetTitleSize(0.05)
#XY_10.GetYaxis().SetLabelSize(0.05)
#XY_10.GetYaxis().SetTitleSize(0.05)
XY_10.Draw("colz")
# t1.Draw()
t2.Draw()
c.Print("dataDSref_200_alltof_XY.pdf")
c.Print("dataDSref_200_alltof_XY_pq.jpg")

c.Clear()
XY_11 = f1.Get("dataDSref_prerad_XY")
#XY_11.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.3.2")
XY_11.SetStats(0)
XY_11.SetTitle("")
# XY_11.SetMaximum(400)
XY_11.SetMinimum(2)
#XY_11.GetXaxis().SetLabelSize(0.05)
#XY_11.GetXaxis().SetTitleSize(0.05)
#XY_11.GetYaxis().SetLabelSize(0.05)
#XY_11.GetYaxis().SetTitleSize(0.05)
XY_11.Draw("colz")
# t1.Draw()
t2.Draw()
c.Print("dataDSref_200_prerad_XY.pdf")
c.Print("dataDSref_200_prerad_XY_pq.jpg")

c.Clear()
XY_12 = f1.Get("dataDSref_XY")
# XY_12.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.3.2")
XY_12.SetStats(0)
XY_12.SetTitle("")
# XY_12.SetMaximum(400)
XY_12.SetMinimum(1)
#XY_12.GetXaxis().SetLabelSize(0.05)
#XY_12.GetXaxis().SetTitleSize(0.05)
#XY_12.GetYaxis().SetLabelSize(0.05)
#XY_12.GetYaxis().SetTitleSize(0.05)
XY_12.Draw("colz")
# t1.Draw()
t2.Draw()
c.Print("dataDSref_200_XY.pdf")
c.Print("dataDSref_200_XY_pq.jpg")

c.Clear()
dXdzdYdz_10 = f1.Get("dataDSref_alltof_dXdzdYdz")
# dXdzdYdz_10.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.3.2")
dXdzdYdz_10.SetStats(0)
dXdzdYdz_10.SetTitle("")
# dXdzdYdz_10.SetMaximum(300)
dXdzdYdz_10.SetMinimum(10)
#dXdzdYdz_10.GetXaxis().SetLabelSize(0.05)
#dXdzdYdz_10.GetXaxis().SetTitleSize(0.05)
#dXdzdYdz_10.GetYaxis().SetLabelSize(0.05)
#dXdzdYdz_10.GetYaxis().SetTitleSize(0.05)
dXdzdYdz_10.GetXaxis().SetNdivisions(508)
dXdzdYdz_10.GetYaxis().SetNdivisions(508)
dXdzdYdz_10.Draw("colz")
# t1.Draw()
t2.Draw()
c.Print("dataDSref_200_alltof_dXdzdYdz.pdf")
c.Print("dataDSref_200_alltof_dXdzdYdz_pq.jpg")

c.Clear()
dXdzdYdz_11 = f1.Get("dataDSref_prerad_dXdzdYdz")
# dXdzdYdz_11.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.3.2")
dXdzdYdz_11.SetStats(0)
dXdzdYdz_11.SetTitle("")
# dXdzdYdz_11.SetMaximum(300)
dXdzdYdz_11.SetMinimum(2)
#dXdzdYdz_11.GetXaxis().SetLabelSize(0.05)
#dXdzdYdz_11.GetXaxis().SetTitleSize(0.05)
#dXdzdYdz_11.GetYaxis().SetLabelSize(0.05)
#dXdzdYdz_11.GetYaxis().SetTitleSize(0.05)
dXdzdYdz_11.GetXaxis().SetNdivisions(508)
dXdzdYdz_11.GetYaxis().SetNdivisions(508)
dXdzdYdz_11.Draw("colz")
# t1.Draw()
t2.Draw()
c.Print("dataDSref_200_prerad_dXdzdYdz.pdf")
c.Print("dataDSref_200_prerad_dXdzdYdz_pq.jpg")

c.Clear()
dXdzdYdz_12 = f1.Get("dataDSref_dXdzdYdz")
# dXdzdYdz_12.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.3.2")
dXdzdYdz_12.SetStats(0)
dXdzdYdz_12.SetTitle("")
# dXdzdYdz_12.SetMaximum(300)
dXdzdYdz_12.SetMinimum(0)
#dXdzdYdz_12.GetXaxis().SetLabelSize(0.05)
#dXdzdYdz_12.GetXaxis().SetTitleSize(0.05)
#dXdzdYdz_12.GetYaxis().SetLabelSize(0.05)
#dXdzdYdz_12.GetYaxis().SetTitleSize(0.05)
dXdzdYdz_12.GetXaxis().SetNdivisions(508)
dXdzdYdz_12.GetYaxis().SetNdivisions(508)
dXdzdYdz_12.Draw("colz")
# t1.Draw()
t2.Draw()
c.Print("dataDSref_200_dXdzdYdz.pdf")
c.Print("dataDSref_200_dXdzdYdz_pq.jpg")


c.Clear()
# c.SetLogy()
hgoldmirrorl = f1.Get("hgoldmirrorl")
hgoldmirrorr = f1.Get("hgoldmirrorr")
hgoldmirrorl.SetStats(0)
hgoldmirrorl.SetTitle("")
# hgoldmirrorl.SetMinimum(0)
hgoldmirrorl.GetYaxis().SetTitle("No. of events")
hgoldmirrorl.GetXaxis().SetTitle("#Delta#theta_X (radians)")
hgoldmirrorr.GetYaxis().SetTitle("No. of events")
hgoldmirrorr.GetXaxis().SetTitle("#Delta#theta_X (radians)")
#hgoldmirrorl.GetXaxis().SetLabelSize(0.05)
#hgoldmirrorl.GetXaxis().SetTitleSize(0.05)
#hgoldmirrorl.GetYaxis().SetLabelSize(0.05)
#hgoldmirrorl.GetYaxis().SetTitleSize(0.05)
hgoldmirrorl.GetXaxis().SetNdivisions(508)
hgoldmirrorl.GetYaxis().SetNdivisions(508)
hgoldmirrorr.SetLineColor(2)
# hgoldmirrorr.GetYaxis().SetRangeUser(0,700)
# hgoldmirrorl.GetYaxis().SetRangeUser(0,700)
hgoldmirrorl.Draw()
hgoldmirrorr.Draw("SAME")
# t1.Draw()
#t7.Draw()
c.Print("mirrorgold.pdf")
c.Print("mirrorgold_pq.jpg")

morehist = ["projposUSDSdiff_GEANT",
            "thetaXUS_thetaXDSGEANT"]
for hist in morehist:
    c.Clear()
    h = f1.Get(hist)
    print hist
    # h.SetTitle("TkU Station 1, LiH 200 MeV/c, March 2016, MAUS v3.3.2")
    h.SetStats(0)
    h.SetTitle("")
    # h.SetMaximum(300)
    h.SetMinimum(0)
#    h.GetXaxis().SetLabelSize(0.05)
#    h.GetXaxis().SetTitleSize(0.05)
#    h.GetYaxis().SetLabelSize(0.05)
#    h.GetYaxis().SetTitleSize(0.05)
    h.GetXaxis().SetNdivisions(508)
    h.GetYaxis().SetNdivisions(508)
    h.Draw("colz")
    # t1.Draw()
    t2.Draw()
    c.Print(hist + "_200.pdf")
    c.Print(hist + "_200_pq.jpg")



# if __name__ == '__main__':


